import { Theme } from "../styles.slint";
import { LineEdit } from "std-widgets.slint";

// Search bar component
export component SearchBar inherits Rectangle {
    in-out property <string> text;
    in property <string> placeholder: "Search settings...";

    callback search-changed(string);

    // Accessibility - container only, LineEdit inside handles text-input role
    accessible-role: none;

    height: Theme.search-height;
    background: Theme.card-background;
    border-radius: Theme.radius-lg;
    border-width: 1px;
    border-color: focus-indicator.has-focus ? Theme.accent : Theme.border;

    animate border-color { duration: Theme.duration-fast; easing: ease-out; }

    HorizontalLayout {
        padding-left: Theme.spacing-md;
        padding-right: Theme.spacing-md;
        spacing: Theme.spacing-sm;

        // Search icon - magnifying glass
        Rectangle {
            width: 20px;
            height: parent.height;

            // Magnifying glass lens (outer ring)
            Rectangle {
                x: 2px;
                y: (parent.height - 16px) / 2;
                width: 11px;
                height: 11px;
                background: transparent;
                border-radius: 6px;
                border-width: 2px;
                border-color: focus-indicator.has-focus ? Theme.accent : Theme.text-muted;

                animate border-color { duration: Theme.duration-fast; }
            }

            // Handle - diagonal dots to simulate 45-degree line
            Rectangle {
                x: 11px;
                y: (parent.height - 16px) / 2 + 10px;
                width: 2px;
                height: 2px;
                background: focus-indicator.has-focus ? Theme.accent : Theme.text-muted;
                border-radius: 1px;
                animate background { duration: Theme.duration-fast; }
            }
            Rectangle {
                x: 13px;
                y: (parent.height - 16px) / 2 + 12px;
                width: 2px;
                height: 2px;
                background: focus-indicator.has-focus ? Theme.accent : Theme.text-muted;
                border-radius: 1px;
                animate background { duration: Theme.duration-fast; }
            }
            Rectangle {
                x: 15px;
                y: (parent.height - 16px) / 2 + 14px;
                width: 2px;
                height: 2px;
                background: focus-indicator.has-focus ? Theme.accent : Theme.text-muted;
                border-radius: 1px;
                animate background { duration: Theme.duration-fast; }
            }
        }

        // Input field
        focus-indicator := LineEdit {
            placeholder-text: placeholder;
            text <=> root.text;

            accessible-label: "Search input field";
            accessible-description: "Type to filter settings";

            edited(value) => {
                root.search-changed(value);
            }
        }
    }
}
