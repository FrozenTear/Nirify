// Main window for niri-settings
//
// Property Organization:
// Properties are organized by category with flat naming convention.
// Struct types in styles.slint are used for models (AnimationConfig).

import { Button, VerticalBox, HorizontalBox, ScrollView } from "std-widgets.slint";
import { Theme, AnimationConfig, SearchResultItem, KeyPart, DiffLineItem, CategoryDiffItem } from "styles.slint";
import { SearchResultsPanel } from "widgets/search_results_panel.slint";
import { Sidebar, SidebarIndices } from "widgets/sidebar.slint";
import { CategoryNav } from "widgets/category_nav.slint";
import { SearchBar } from "widgets/search.slint";
import { SettingsSection, SettingRow } from "widgets/section.slint";
// Dynamic pages (full dynamic migration)
import { AnimationsDynamicPage, AnimationSettingModel } from "pages/animations.slint";
import { AppearanceDynamicPage, AppearanceSettingModel } from "pages/appearance.slint";
import { BehaviorDynamicPage, BehaviorSettingModel } from "pages/behavior.slint";
import { CursorDynamicPage, CursorSettingModel } from "pages/cursor.slint";
import { DebugDynamicPage, DebugSettingModel } from "pages/debug.slint";
import { GesturesDynamicPage, GestureSettingModel } from "pages/gestures.slint";
import { KeyboardDynamicPage, KeyboardSettingModel } from "pages/keyboard.slint";
import { LayoutExtrasDynamicPage, LayoutSettingModel } from "pages/layout_extras.slint";
import { MiscellaneousDynamicPage, MiscSettingModel } from "pages/miscellaneous.slint";
import { MouseDynamicPage, MouseSettingModel } from "pages/mouse.slint";
import { OverviewDynamicPage, OverviewSettingModel } from "pages/overview.slint";
import { SwitchEventsDynamicPage, SwitchEventSettingModel } from "pages/switch_events.slint";
import { TouchpadDynamicPage, TouchpadSettingModel } from "pages/touchpad.slint";
import { WindowRulesPageDynamic, WindowRuleSettingModel } from "pages/window_rules.slint";
import { LayerRulesDynamicPage, LayerRuleSettingModel } from "pages/layer_rules.slint";
import { WorkspacesDynamicPage, WorkspaceSettingModel } from "pages/workspaces.slint";
import { TrackpointDynamicPage, TrackpointSettingModel } from "pages/trackpoint.slint";
import { StartupDynamicPage } from "pages/startup.slint";
import { EnvironmentDynamicPage, EnvironmentVariableModel } from "pages/environment.slint";
import { RecentWindowsDynamicPage, RecentWindowsSettingModel } from "pages/recent_windows.slint";
import { TrackballDynamicPage, TrackballSettingModel } from "pages/trackball.slint";
import { TabletDynamicPage, TabletSettingModel } from "pages/tablet.slint";
import { TouchDynamicPage, TouchSettingModel } from "pages/touch.slint";

// Static pages (not yet migrated to dynamic)
import { DisplaysPage } from "pages/displays.slint";
import { KeybindingsPage, KeybindingItem } from "pages/keybindings.slint";
import { ToolsPage } from "pages/tools.slint";
import { ConfigEditorPage } from "pages/config_editor.slint";
import { BackupsPage, BackupEntry } from "pages/backups.slint";
import { FirstRunWizard } from "dialogs/first_run_wizard.slint";
import { MessageDialog, StatusNotification, DialogType } from "dialogs/error_dialog.slint";
import { ImportSummaryDialog } from "dialogs/import_summary.slint";
import { DiffViewDialog } from "dialogs/diff_view.slint";
import { ConsolidationDialog, ConsolidationItem } from "dialogs/consolidation_dialog.slint";

// Export structs for Rust access
export {
    WindowRuleSettingModel,
    LayerRuleSettingModel,
    AnimationSettingModel,
    AppearanceSettingModel,
    BehaviorSettingModel,
    CursorSettingModel,
    DebugSettingModel,
    GestureSettingModel,
    KeyboardSettingModel,
    LayoutSettingModel,
    MiscSettingModel,
    MouseSettingModel,
    OverviewSettingModel,
    SwitchEventSettingModel,
    TouchpadSettingModel,
    WorkspaceSettingModel,
    RecentWindowsSettingModel,
    TrackpointSettingModel,
    TrackballSettingModel,
    TabletSettingModel,
    TouchSettingModel,
    EnvironmentVariableModel
}

export component MainWindow inherits Window {
    title: "Niri Settings";
    min-width: 600px;
    min-height: 500px;
    preferred-width: 800px;
    preferred-height: 600px;
    background: Theme.background;

    in-out property <int> selected-category: 0;
    in-out property <string> search-text: "";

    // Search results
    in property <[SearchResultItem]> search-results: [];
    in-out property <bool> show-search-results: false;

    // Appearance settings
    in-out property <bool> focus-ring-enabled: true;
    in-out property <float> focus-ring-width: 4;
    in-out property <color> focus-ring-active-color: #7fc8ff;
    in-out property <color> focus-ring-inactive-color: #505050;
    in-out property <color> focus-ring-urgent-color: #ff5555;
    in-out property <string> focus-ring-active-hex: "#7fc8ff";
    in-out property <string> focus-ring-inactive-hex: "#505050";
    in-out property <string> focus-ring-urgent-hex: "#ff5555";
    in-out property <bool> border-enabled: false;
    in-out property <float> border-thickness: 1;
    in-out property <color> border-active-color: #ffffff;
    in-out property <color> border-inactive-color: #808080;
    in-out property <color> border-urgent-color: #ff5555;
    in-out property <string> border-active-hex: "#ffffff";
    in-out property <string> border-inactive-hex: "#808080";
    in-out property <string> border-urgent-hex: "#ff5555";
    in-out property <float> gaps: 16;
    in-out property <float> corner-radius: 12;
    in-out property <color> background-color: #1e1e2e;
    in-out property <string> background-color-hex: "#1e1e2e";

    // Behavior settings
    in-out property <bool> focus-follows-mouse: false;
    in-out property <bool> warp-mouse-to-focus: false;
    in-out property <bool> center-focused-column: false;
    in-out property <bool> always-center-single-column: false;
    in-out property <int> default-column-width-index: 0;
    in-out property <float> default-column-width-proportion: 0.5;
    in-out property <float> default-column-width-fixed: 800;
    in-out property <float> strut-left: 0;
    in-out property <float> strut-right: 0;
    in-out property <float> strut-top: 0;
    in-out property <float> strut-bottom: 0;
    in-out property <int> mod-key-index: 0;
    in-out property <bool> mod-key-nested-enabled: false;
    in-out property <int> mod-key-nested-index: 0;
    in-out property <bool> disable-power-key-handling: false;

    // Cursor settings
    in-out property <string> cursor-theme: "";
    in-out property <int> cursor-size: 24;
    in-out property <bool> hide-when-typing: false;
    in-out property <bool> hide-after-inactive-enabled: false;
    in-out property <int> hide-after-inactive-ms: 1000;

    // Animation settings
    in-out property <bool> animations-enabled: true;
    in-out property <float> animations-slowdown: 1.0;

    // Animation configurations as a model (11 animations)
    // Replaces 66 individual properties with a single model
    in property <[AnimationConfig]> animations-model;

    // Overview settings
    in-out property <float> overview-zoom: 0.5;
    in-out property <bool> overview-backdrop-enabled: false;
    in-out property <color> overview-backdrop-color: #000000;
    in-out property <string> overview-backdrop-hex: "#000000";

    // Phase 8: Workspace shadow
    in-out property <bool> overview-workspace-shadow-enabled: false;
    in-out property <float> overview-workspace-shadow-softness: 30;
    in-out property <float> overview-workspace-shadow-spread: 10;
    in-out property <float> overview-workspace-shadow-offset-x: 0;
    in-out property <float> overview-workspace-shadow-offset-y: 5;
    in-out property <color> overview-workspace-shadow-color: #00000080;
    in-out property <string> overview-workspace-shadow-color-hex: "#00000080";

    // Keyboard settings
    // Note: Keyboard cannot be disabled in niri, so no "off" property
    in-out property <string> xkb-layout: "us";
    in-out property <string> xkb-variant: "";
    in-out property <string> xkb-model: "";
    in-out property <string> xkb-rules: "";
    in-out property <string> xkb-options: "";
    in-out property <string> xkb-file: "";  // Path to custom .xkb keymap file
    in-out property <int> repeat-delay: 600;
    in-out property <int> repeat-rate: 25;
    in-out property <bool> numlock: false;
    in-out property <int> track-layout-index: 0;

    // Mouse settings
    in-out property <bool> mouse-off: false;
    in-out property <bool> mouse-natural-scroll: false;
    in-out property <bool> mouse-left-handed: false;
    in-out property <float> mouse-accel-speed: 0.0;
    in-out property <int> mouse-accel-profile-index: 0;
    in-out property <float> mouse-scroll-factor: 1.0;
    in-out property <int> mouse-scroll-method-index: 3;
    in-out property <bool> mouse-middle-emulation: false;
    in-out property <int> mouse-scroll-button: 0;  // Button code for on-button-down scrolling
    in-out property <bool> mouse-scroll-button-lock: false;  // Toggle scroll mode

    // Touchpad settings
    in-out property <bool> touchpad-off: false;
    in-out property <bool> touchpad-tap: true;
    in-out property <int> touchpad-tap-button-map-index: 0;
    in-out property <bool> touchpad-natural-scroll: true;
    in-out property <int> touchpad-scroll-method-index: 0;
    in-out property <float> touchpad-scroll-factor: 1.0;
    in-out property <int> touchpad-click-method-index: 0;
    in-out property <bool> touchpad-middle-emulation: false;
    in-out property <bool> touchpad-left-handed: false;
    in-out property <bool> touchpad-dwt: true;
    in-out property <bool> touchpad-dwtp: false;
    in-out property <bool> touchpad-drag: true;
    in-out property <bool> touchpad-drag-lock: false;
    in-out property <float> touchpad-accel-speed: 0.0;
    in-out property <int> touchpad-accel-profile-index: 0;
    in-out property <bool> touchpad-disabled-on-external-mouse: false;
    in-out property <int> touchpad-scroll-button: 0;  // Button code for on-button-down scrolling
    in-out property <bool> touchpad-scroll-button-lock: false;  // Toggle scroll mode

    // Note: Trackpoint, Trackball, Tablet, and Touch settings now use dynamic pages
    // Static properties removed - see *-dynamic-* properties below

    // Display/Output settings
    in-out property <[string]> output-list: [];
    in-out property <[string]> discovered-outputs: [];
    in-out property <string> output-names: "";
    in-out property <int> selected-output-index: -1;
    in-out property <string> current-output-name: "";
    in-out property <bool> current-output-enabled: true;
    in-out property <float> current-output-scale: 1.0;
    in-out property <string> current-output-mode: "";
    in-out property <int> current-output-pos-x: 0;
    in-out property <int> current-output-pos-y: 0;
    in-out property <int> current-output-transform-index: 0;
    in-out property <int> current-output-vrr-index: 0;
    in-out property <string> new-output-name: "";

    // Available display modes for current output
    in-out property <[string]> available-modes: [];
    in-out property <int> selected-mode-index: -1;
    in-out property <bool> use-custom-mode: false;

    // Phase 8: Per-output custom mode/modeline
    in-out property <bool> current-output-mode-custom: false;
    in-out property <string> current-output-modeline: "";

    // Phase 8: Per-output hot corners
    in-out property <bool> current-output-hot-corners-enabled: false;
    in-out property <bool> current-output-hc-override-enabled: false;
    in-out property <bool> current-output-hc-top-left: false;
    in-out property <bool> current-output-hc-top-right: false;
    in-out property <bool> current-output-hc-bottom-left: false;
    in-out property <bool> current-output-hc-bottom-right: false;

    // Phase 8: Per-output layout override
    in-out property <bool> current-output-layout-override-enabled: false;
    in-out property <float> current-output-layout-gaps-inner: 8;
    in-out property <float> current-output-layout-gaps-outer: 8;
    in-out property <float> current-output-layout-struts-left: 0;
    in-out property <float> current-output-layout-struts-right: 0;
    in-out property <float> current-output-layout-struts-top: 0;
    in-out property <float> current-output-layout-struts-bottom: 0;
    in-out property <int> current-output-layout-center-index: 0;

    // Layout Extras - Shadow settings
    in-out property <bool> shadow-enabled: true;
    in-out property <int> shadow-softness: 30;
    in-out property <int> shadow-spread: 5;
    in-out property <int> shadow-offset-x: 0;
    in-out property <int> shadow-offset-y: 5;
    in-out property <bool> shadow-draw-behind: false;
    in-out property <color> shadow-color: #00000070;
    in-out property <color> shadow-inactive-color: #00000050;
    in-out property <string> shadow-color-hex: "#00000070";
    in-out property <string> shadow-inactive-color-hex: "#00000050";

    // Layout Extras - Tab indicator settings
    in-out property <bool> tab-indicator-enabled: true;
    in-out property <bool> tab-indicator-hide-single: false;
    in-out property <bool> tab-indicator-within-column: false;
    in-out property <int> tab-indicator-gap: 5;
    in-out property <int> tab-indicator-width: 4;
    in-out property <int> tab-indicator-position-index: 0;
    in-out property <int> tab-indicator-corner-radius: 8;
    in-out property <int> tab-indicator-gaps-between: 2;
    in-out property <color> tab-indicator-active-color: #7fc8ff;
    in-out property <color> tab-indicator-inactive-color: #505050;
    in-out property <color> tab-indicator-urgent-color: #eb6f92;
    in-out property <string> tab-indicator-active-hex: "#7fc8ff";
    in-out property <string> tab-indicator-inactive-hex: "#505050";
    in-out property <string> tab-indicator-urgent-hex: "#eb6f92";

    // Layout Extras - Insert hint settings
    in-out property <bool> insert-hint-enabled: true;
    in-out property <color> insert-hint-color: #ffc87f80;
    in-out property <string> insert-hint-color-hex: "#ffc87f80";

    // Gestures - Hot corners
    in-out property <bool> hot-corners-enabled: false;
    in-out property <bool> hot-corner-top-left: true;
    in-out property <bool> hot-corner-top-right: false;
    in-out property <bool> hot-corner-bottom-left: false;
    in-out property <bool> hot-corner-bottom-right: false;

    // Gestures - DND edge view scroll
    in-out property <bool> dnd-edge-scroll-enabled: true;
    in-out property <int> dnd-edge-scroll-trigger-width: 30;
    in-out property <int> dnd-edge-scroll-delay: 100;
    in-out property <int> dnd-edge-scroll-max-speed: 1500;

    // Gestures - DND workspace switch
    in-out property <bool> dnd-workspace-switch-enabled: true;
    in-out property <int> dnd-workspace-switch-trigger-height: 50;
    in-out property <int> dnd-workspace-switch-delay: 100;
    in-out property <int> dnd-workspace-switch-max-speed: 1500;

    // Miscellaneous settings
    in-out property <bool> prefer-no-csd: false;
    in-out property <string> screenshot-path: "~/Pictures/Screenshots/Screenshot from %Y-%m-%d %H-%M-%S.png";
    in-out property <bool> disable-primary-clipboard: false;
    in-out property <bool> hotkey-overlay-skip: false;

    // Phase 8: New misc settings
    in-out property <bool> hotkey-overlay-hide-not-bound: false;
    in-out property <bool> config-notification-disable-failed: false;

    // New misc settings (v25.08+)
    in-out property <bool> spawn-sh-at-startup: false;
    in-out property <int> xwayland-satellite-index: 0;
    in-out property <string> xwayland-satellite-path: "";

    // Developer options
    in-out property <bool> show-debug-options: false;

    // Window Rules settings
    in-out property <[string]> window-rules-list: [];
    in-out property <int> selected-window-rule-index: -1;
    in-out property <string> current-rule-name: "";
    // Multi-match support
    in-out property <[string]> current-matches-list: [];
    in-out property <int> selected-match-index: 0;
    in-out property <int> current-matches-count: 0;
    in-out property <string> current-match-app-id: "";
    in-out property <string> current-match-title: "";
    // Advanced match criteria (0=Any, 1=Yes, 2=No)
    in-out property <int> current-match-is-floating: 0;
    in-out property <int> current-match-is-active: 0;
    in-out property <int> current-match-is-focused: 0;
    in-out property <int> current-match-is-active-in-column: 0;
    in-out property <int> current-match-is-window-cast-target: 0;
    in-out property <int> current-match-is-urgent: 0;
    in-out property <int> current-match-at-startup: 0;
    // Window picker (for selecting from running windows)
    in-out property <[string]> running-windows-list: [];
    in-out property <bool> show-window-picker: false;
    in-out property <int> current-open-behavior-index: 0;
    in-out property <bool> current-has-opacity: false;
    in-out property <float> current-opacity: 1.0;
    in-out property <bool> current-block-screencast: false;
    in-out property <bool> current-has-corner-radius: false;
    in-out property <int> current-corner-radius: 12;
    in-out property <bool> current-clip-to-geometry: false;
    in-out property <string> current-open-on-output: "";
    in-out property <string> current-open-on-workspace: "";
    // New dynamic properties
    in-out property <int> current-vrr-index: 0;
    in-out property <int> current-column-display-index: 0;
    in-out property <int> current-tiled-state-index: 0;
    in-out property <bool> current-baba-is-float: false;
    // Floating position (for floating windows)
    in-out property <bool> current-has-floating-position: false;
    in-out property <int> current-floating-x: 0;
    in-out property <int> current-floating-y: 0;
    in-out property <int> current-floating-relative-to: 0;
    // Per-window shadow override
    in-out property <int> current-shadow-mode: 0;
    in-out property <int> current-shadow-softness: 30;
    in-out property <int> current-shadow-spread: 5;
    in-out property <int> current-shadow-offset-x: 0;
    in-out property <int> current-shadow-offset-y: 5;
    in-out property <string> current-shadow-color: "#00000070";
    in-out property <string> current-shadow-inactive-color: "#00000040";
    in-out property <bool> current-shadow-draw-behind-window: false;
    // Per-window tab-indicator override
    in-out property <int> current-tab-indicator-mode: 0;
    in-out property <bool> current-tab-indicator-hide-when-single: false;
    in-out property <bool> current-tab-indicator-place-within-column: false;
    in-out property <int> current-tab-indicator-gap: 5;
    in-out property <int> current-tab-indicator-width: 4;
    in-out property <float> current-tab-indicator-length: 1.0;
    in-out property <int> current-tab-indicator-position: 0;
    in-out property <int> current-tab-indicator-gaps-between-tabs: 2;
    in-out property <int> current-tab-indicator-corner-radius: 8;
    in-out property <string> current-tab-indicator-active-color: "#cba6f7";
    in-out property <string> current-tab-indicator-inactive-color: "#45475a";

    // Dynamic Window Rules (model-based approach)
    in-out property <[string]> window-rules-list-dynamic: [];
    in-out property <int> selected-window-rule-index-dynamic: -1;
    in-out property <[string]> window-rules-matches-list-dynamic: [];
    in-out property <int> selected-match-index-dynamic: 0;
    in-out property <[string]> window-rules-running-windows-dynamic: [];
    in-out property <bool> window-rules-show-picker-dynamic: false;
    in-out property <[WindowRuleSettingModel]> window-rules-rule-settings: [];
    in-out property <[WindowRuleSettingModel]> window-rules-match-settings: [];
    in-out property <[WindowRuleSettingModel]> window-rules-opening-settings: [];
    in-out property <[WindowRuleSettingModel]> window-rules-visual-settings: [];
    in-out property <[WindowRuleSettingModel]> window-rules-shadow-settings: [];
    in-out property <[WindowRuleSettingModel]> window-rules-tab-settings: [];
    callback window-rule-add-dynamic();
    callback window-rule-remove-dynamic(int);
    callback window-rule-select-dynamic(int);
    callback window-rule-reorder-dynamic(int, int);
    callback window-rule-add-match-dynamic();
    callback window-rule-remove-match-dynamic(int);
    callback window-rule-select-match-dynamic(int);
    callback window-rule-refresh-windows-dynamic();
    callback window-rule-select-running-window-dynamic(int);
    callback window-rule-setting-toggle-changed(string, bool);
    callback window-rule-setting-slider-int-changed(string, int);
    callback window-rule-setting-slider-float-changed(string, float);
    callback window-rule-setting-combo-changed(string, int);
    callback window-rule-setting-text-changed(string, string);

    // Named Workspaces settings
    in-out property <[string]> workspaces-list: [];
    in-out property <int> selected-workspace-index: -1;
    in-out property <string> current-workspace-name: "";
    in-out property <string> current-workspace-open-on-output: "";
    in-out property <bool> current-workspace-has-layout-override: false;
    in-out property <bool> current-workspace-has-gaps-override: false;
    in-out property <float> current-workspace-gaps-inner: 16;
    in-out property <float> current-workspace-gaps-outer: 8;
    in-out property <bool> current-workspace-has-struts-override: false;
    in-out property <float> current-workspace-strut-left: 0;
    in-out property <float> current-workspace-strut-right: 0;
    in-out property <float> current-workspace-strut-top: 0;
    in-out property <float> current-workspace-strut-bottom: 0;
    in-out property <bool> current-workspace-has-center-override: false;
    in-out property <int> current-workspace-center-focused-column-index: 0;
    in-out property <bool> current-workspace-always-center-single-column: false;

    // Dynamic Named Workspaces (model-based approach)
    in-out property <[string]> workspaces-list-dynamic: [];
    in-out property <int> selected-workspace-index-dynamic: -1;
    in-out property <bool> workspace-has-layout-override-dynamic: false;
    in-out property <bool> workspace-has-gaps-override-dynamic: false;
    in-out property <bool> workspace-has-struts-override-dynamic: false;
    in-out property <bool> workspace-has-center-override-dynamic: false;
    in-out property <[WorkspaceSettingModel]> workspace-identity-settings-dynamic: [];
    in-out property <[WorkspaceSettingModel]> workspace-layout-override-settings-dynamic: [];
    in-out property <[WorkspaceSettingModel]> workspace-gaps-settings-dynamic: [];
    in-out property <[WorkspaceSettingModel]> workspace-struts-settings-dynamic: [];
    in-out property <[WorkspaceSettingModel]> workspace-centering-settings-dynamic: [];
    callback workspace-add-dynamic();
    callback workspace-remove-dynamic(int);
    callback workspace-select-dynamic(int);
    callback workspace-reorder-dynamic(int, int);
    callback workspace-setting-toggle-changed(string, bool);
    callback workspace-setting-slider-int-changed(string, int);
    callback workspace-setting-slider-float-changed(string, float);
    callback workspace-setting-combo-changed(string, int);
    callback workspace-setting-text-changed(string, string);

    // Layer Rules settings
    in-out property <[string]> layer-rules-list: [];
    in-out property <int> selected-layer-rule-index: -1;
    in-out property <string> current-layer-rule-name: "";
    in-out property <[string]> current-layer-rule-matches-list: [];
    in-out property <int> selected-layer-rule-match-index: 0;
    in-out property <int> current-layer-rule-matches-count: 0;
    in-out property <string> current-layer-rule-match-namespace: "";
    in-out property <bool> current-layer-rule-match-at-startup: false;
    in-out property <bool> current-layer-rule-match-has-at-startup: false;
    in-out property <bool> current-layer-rule-has-block-out-from: false;
    in-out property <int> current-layer-rule-block-out-from-index: 0;
    in-out property <bool> current-layer-rule-has-opacity: false;
    in-out property <float> current-layer-rule-opacity: 1.0;
    in-out property <bool> current-layer-rule-has-corner-radius: false;
    in-out property <int> current-layer-rule-corner-radius: 12;
    in-out property <bool> current-layer-rule-place-within-backdrop: false;
    in-out property <bool> current-layer-rule-baba-is-float: false;
    in-out property <bool> current-layer-rule-has-shadow: false;
    in-out property <bool> current-layer-rule-shadow-enabled: true;
    in-out property <int> current-layer-rule-shadow-softness: 30;
    in-out property <int> current-layer-rule-shadow-spread: 5;
    in-out property <int> current-layer-rule-shadow-offset-x: 0;
    in-out property <int> current-layer-rule-shadow-offset-y: 5;
    in-out property <bool> current-layer-rule-shadow-draw-behind: false;
    in-out property <color> current-layer-rule-shadow-color: #00000070;
    in-out property <color> current-layer-rule-shadow-inactive-color: #00000050;
    in-out property <string> current-layer-rule-shadow-color-hex: "#00000070";
    in-out property <string> current-layer-rule-shadow-inactive-color-hex: "#00000050";

    // Dynamic Layer Rules
    in-out property <[string]> layer-rules-list-dynamic: [];
    in-out property <int> layer-rules-selected-index: -1;
    in-out property <[string]> layer-rules-matches-list: [];
    in-out property <int> layer-rules-selected-match-index: 0;
    in-out property <int> layer-rules-matches-count: 0;
    in-out property <[LayerRuleSettingModel]> layer-rules-rule-settings: [];
    in-out property <[LayerRuleSettingModel]> layer-rules-match-settings: [];
    in-out property <[LayerRuleSettingModel]> layer-rules-visual-settings: [];
    in-out property <[LayerRuleSettingModel]> layer-rules-shadow-settings: [];
    in-out property <[LayerRuleSettingModel]> layer-rules-advanced-settings: [];

    // Dynamic Cursor settings
    in-out property <[CursorSettingModel]> cursor-theme-settings: [];
    in-out property <[CursorSettingModel]> cursor-visibility-settings: [];

    // Dynamic Appearance settings
    in-out property <[AppearanceSettingModel]> appearance-focus-ring-settings: [];
    in-out property <[AppearanceSettingModel]> appearance-border-settings: [];
    in-out property <[AppearanceSettingModel]> appearance-background-settings: [];
    in-out property <[AppearanceSettingModel]> appearance-gaps-settings: [];
    in-out property <[AppearanceSettingModel]> appearance-corners-settings: [];

    // Dynamic Behavior settings
    in-out property <[BehaviorSettingModel]> behavior-focus-settings: [];
    in-out property <[BehaviorSettingModel]> behavior-workspace-settings: [];
    in-out property <[BehaviorSettingModel]> behavior-window-size-settings: [];
    in-out property <[BehaviorSettingModel]> behavior-strut-settings: [];
    in-out property <[BehaviorSettingModel]> behavior-modifier-settings: [];
    in-out property <[BehaviorSettingModel]> behavior-power-settings: [];

    // Dynamic Overview settings
    in-out property <[OverviewSettingModel]> overview-appearance-settings: [];
    in-out property <[OverviewSettingModel]> overview-backdrop-settings: [];
    in-out property <[OverviewSettingModel]> overview-shadow-settings: [];

    // Dynamic Keyboard settings
    // Note: Keyboard cannot be disabled in niri, so no "off" property
    in-out property <[KeyboardSettingModel]> keyboard-dynamic-layout-settings: [];
    in-out property <[KeyboardSettingModel]> keyboard-dynamic-repeat-settings: [];
    in-out property <[KeyboardSettingModel]> keyboard-dynamic-other-settings: [];
    in-out property <[KeyboardSettingModel]> keyboard-dynamic-advanced-settings: [];

    // Dynamic Mouse settings
    in-out property <bool> mouse-dynamic-device-off: false;
    in-out property <[MouseSettingModel]> mouse-dynamic-device-settings: [];
    in-out property <[MouseSettingModel]> mouse-dynamic-basic-settings: [];
    in-out property <[MouseSettingModel]> mouse-dynamic-acceleration-settings: [];
    in-out property <[MouseSettingModel]> mouse-dynamic-scrolling-settings: [];

    // Dynamic Touchpad settings
    in-out property <bool> touchpad-dynamic-device-off: false;
    in-out property <[TouchpadSettingModel]> touchpad-dynamic-device-control-settings: [];
    in-out property <[TouchpadSettingModel]> touchpad-dynamic-tap-settings: [];
    in-out property <[TouchpadSettingModel]> touchpad-dynamic-scroll-settings: [];
    in-out property <[TouchpadSettingModel]> touchpad-dynamic-click-settings: [];
    in-out property <[TouchpadSettingModel]> touchpad-dynamic-palm-rejection-settings: [];
    in-out property <[TouchpadSettingModel]> touchpad-dynamic-drag-settings: [];
    in-out property <[TouchpadSettingModel]> touchpad-dynamic-acceleration-settings: [];
    in-out property <[TouchpadSettingModel]> touchpad-dynamic-other-settings: [];

    // Dynamic Layout Extras settings
    in-out property <[LayoutSettingModel]> layout-extras-shadow-settings: [];
    in-out property <[LayoutSettingModel]> layout-extras-tab-indicator-settings: [];
    in-out property <[LayoutSettingModel]> layout-extras-insert-hint-settings: [];

    // Dynamic Gestures settings
    in-out property <bool> gestures-hot-corners-enabled: false;
    in-out property <bool> gestures-hot-corner-top-left: false;
    in-out property <bool> gestures-hot-corner-top-right: false;
    in-out property <bool> gestures-hot-corner-bottom-left: false;
    in-out property <bool> gestures-hot-corner-bottom-right: false;
    in-out property <[GestureSettingModel]> gestures-hot-corners-settings: [];
    in-out property <[GestureSettingModel]> gestures-dnd-edge-scroll-settings: [];
    in-out property <[GestureSettingModel]> gestures-dnd-workspace-switch-settings: [];

    // Dynamic Miscellaneous settings
    in-out property <[MiscSettingModel]> misc-decorations-settings: [];
    in-out property <[MiscSettingModel]> misc-screenshots-settings: [];
    in-out property <MiscSettingModel> misc-screenshot-path-setting;
    in-out property <[MiscSettingModel]> misc-clipboard-settings: [];
    in-out property <[MiscSettingModel]> misc-hotkey-overlay-settings: [];
    in-out property <[MiscSettingModel]> misc-config-notification-settings: [];
    in-out property <[MiscSettingModel]> misc-startup-settings: [];
    in-out property <[MiscSettingModel]> misc-xwayland-settings: [];
    in-out property <MiscSettingModel> misc-xwayland-path-setting;
    in-out property <[MiscSettingModel]> misc-developer-settings: [];

    // Dynamic Debug settings
    in-out property <[DebugSettingModel]> debug-rendering-settings: [];
    in-out property <[DebugSettingModel]> debug-gpu-settings: [];
    in-out property <[DebugSettingModel]> debug-frame-timing-settings: [];
    in-out property <[DebugSettingModel]> debug-window-management-settings: [];
    in-out property <[DebugSettingModel]> debug-system-settings: [];
    in-out property <[DebugSettingModel]> debug-screencasting-settings: [];

    // Dynamic Animation settings
    in-out property <bool> anim-animations-enabled: true;
    in-out property <[AnimationSettingModel]> anim-global-settings: [];
    in-out property <[AnimationSettingModel]> anim-workspace-nav-animations: [];
    in-out property <[AnimationSettingModel]> anim-window-animations: [];
    in-out property <[AnimationSettingModel]> anim-ui-animations: [];
    in-out property <[AnimationSettingModel]> anim-spring-params-0: [];
    in-out property <[AnimationSettingModel]> anim-easing-params-0: [];
    in-out property <[AnimationSettingModel]> anim-spring-params-1: [];
    in-out property <[AnimationSettingModel]> anim-easing-params-1: [];
    in-out property <[AnimationSettingModel]> anim-spring-params-2: [];
    in-out property <[AnimationSettingModel]> anim-easing-params-2: [];
    in-out property <[AnimationSettingModel]> anim-spring-params-3: [];
    in-out property <[AnimationSettingModel]> anim-easing-params-3: [];
    in-out property <[AnimationSettingModel]> anim-spring-params-4: [];
    in-out property <[AnimationSettingModel]> anim-easing-params-4: [];
    in-out property <[AnimationSettingModel]> anim-spring-params-5: [];
    in-out property <[AnimationSettingModel]> anim-easing-params-5: [];
    in-out property <[AnimationSettingModel]> anim-spring-params-6: [];
    in-out property <[AnimationSettingModel]> anim-easing-params-6: [];
    in-out property <[AnimationSettingModel]> anim-spring-params-7: [];
    in-out property <[AnimationSettingModel]> anim-easing-params-7: [];
    in-out property <[AnimationSettingModel]> anim-spring-params-8: [];
    in-out property <[AnimationSettingModel]> anim-easing-params-8: [];
    in-out property <[AnimationSettingModel]> anim-spring-params-9: [];
    in-out property <[AnimationSettingModel]> anim-easing-params-9: [];
    in-out property <[AnimationSettingModel]> anim-spring-params-10: [];
    in-out property <[AnimationSettingModel]> anim-easing-params-10: [];

    // Dynamic Switch Events settings
    in-out property <[SwitchEventSettingModel]> switch-events-general-settings: [];
    in-out property <[string]> switch-events-lid-close-commands: [];
    in-out property <int> switch-events-lid-close-selected: -1;
    in-out property <string> switch-events-lid-close-current: "";
    in-out property <[string]> switch-events-lid-open-commands: [];
    in-out property <int> switch-events-lid-open-selected: -1;
    in-out property <string> switch-events-lid-open-current: "";
    in-out property <[string]> switch-events-tablet-mode-on-commands: [];
    in-out property <int> switch-events-tablet-mode-on-selected: -1;
    in-out property <string> switch-events-tablet-mode-on-current: "";
    in-out property <[string]> switch-events-tablet-mode-off-commands: [];
    in-out property <int> switch-events-tablet-mode-off-selected: -1;
    in-out property <string> switch-events-tablet-mode-off-current: "";

    // Keybindings (full editing support)
    in-out property <[KeybindingItem]> keybindings-list: [];
    in-out property <int> selected-keybinding-index: -1;
    in-out property <bool> keybindings-loaded: false;
    in-out property <string> keybindings-source-file: "";
    in-out property <string> keybindings-error: "";
    // Keybinding editor state
    in-out property <bool> keybinding-editor-visible: false;
    in-out property <string> edit-key-combo: "";
    in-out property <[KeyPart]> edit-key-parts: [];  // Parsed parts for badge display
    in-out property <bool> keybinding-capturing: false;  // Key capture mode active
    in-out property <string> edit-overlay-title: "";
    in-out property <bool> edit-allow-when-locked: false;
    in-out property <bool> edit-repeat: false;
    in-out property <int> edit-cooldown: 0;
    in-out property <int> edit-action-type: 0;  // 0=spawn, 1=niri, 2=niri-args
    in-out property <string> edit-action-command: "";
    in-out property <string> edit-action-name: "";

    // Startup commands (spawn-at-startup)
    in-out property <[string]> startup-command-list: [];
    in-out property <int> selected-startup-index: -1;
    in-out property <string> current-startup-command: "";

    // Environment variables
    in-out property <[string]> environment-variable-list: [];
    in-out property <int> selected-environment-index: -1;
    in-out property <string> current-env-name: "";
    in-out property <string> current-env-value: "";

    // Debug settings
    in-out property <bool> debug-expert-mode: false;  // Gates dangerous settings
    in-out property <bool> debug-preview-render: false;
    in-out property <bool> debug-enable-overlay-planes: false;
    in-out property <bool> debug-disable-cursor-plane: false;
    in-out property <bool> debug-disable-direct-scanout: false;
    in-out property <bool> debug-restrict-primary-scanout-to-matching-format: false;
    in-out property <string> debug-render-drm-device: "";
    in-out property <string> debug-ignore-drm-devices: "";
    in-out property <bool> debug-wait-for-frame-completion: false;
    in-out property <bool> debug-disable-resize-throttling: false;
    in-out property <bool> debug-disable-transactions: false;
    in-out property <bool> debug-emulate-zero-presentation-time: false;
    in-out property <bool> debug-skip-cursor-only-updates-during-vrr: false;
    in-out property <bool> debug-dbus-interfaces-in-non-session: false;
    in-out property <bool> debug-keep-laptop-panel-on-lid-closed: false;
    in-out property <bool> debug-disable-monitor-names: false;
    in-out property <bool> debug-force-disable-connectors-on-resume: false;
    in-out property <bool> debug-strict-new-window-focus: false;
    in-out property <bool> debug-honor-xdg-activation-with-invalid-serial: false;
    in-out property <bool> debug-deactivate-unfocused-windows: false;
    in-out property <bool> debug-force-pipewire-invalid-modifier: false;

    // Switch events
    in-out property <[string]> switch-lid-close-commands: [];
    in-out property <int> switch-lid-close-selected: -1;
    in-out property <string> switch-lid-close-current: "";
    in-out property <[string]> switch-lid-open-commands: [];
    in-out property <int> switch-lid-open-selected: -1;
    in-out property <string> switch-lid-open-current: "";
    in-out property <[string]> switch-tablet-mode-on-commands: [];
    in-out property <int> switch-tablet-mode-on-selected: -1;
    in-out property <string> switch-tablet-mode-on-current: "";
    in-out property <[string]> switch-tablet-mode-off-commands: [];
    in-out property <int> switch-tablet-mode-off-selected: -1;
    in-out property <string> switch-tablet-mode-off-current: "";

    // Recent windows settings (v25.05+)
    in-out property <bool> recent-windows-enabled: true;
    in-out property <int> recent-windows-debounce-ms: 100;
    in-out property <int> recent-windows-open-delay-ms: 200;
    in-out property <color> recent-windows-highlight-active-color: #7fc8ff;
    in-out property <string> recent-windows-highlight-active-color-hex: "#7fc8ff";
    in-out property <color> recent-windows-highlight-urgent-color: #eb6f92;
    in-out property <string> recent-windows-highlight-urgent-color-hex: "#eb6f92";
    in-out property <int> recent-windows-highlight-padding: 8;
    in-out property <int> recent-windows-highlight-corner-radius: 12;
    in-out property <int> recent-windows-previews-max-height: 200;
    in-out property <float> recent-windows-previews-max-scale: 0.5;

    // Dynamic Recent Windows settings
    in-out property <bool> recent-windows-dynamic-feature-enabled: true;
    in-out property <[RecentWindowsSettingModel]> recent-windows-dynamic-general-settings: [];
    in-out property <[RecentWindowsSettingModel]> recent-windows-dynamic-highlight-settings: [];
    in-out property <[RecentWindowsSettingModel]> recent-windows-dynamic-preview-settings: [];

    // Dynamic Trackpoint settings
    in-out property <bool> trackpoint-dynamic-device-off: false;
    in-out property <[TrackpointSettingModel]> trackpoint-dynamic-general-settings: [];
    in-out property <[TrackpointSettingModel]> trackpoint-dynamic-behavior-settings: [];
    in-out property <[TrackpointSettingModel]> trackpoint-dynamic-acceleration-settings: [];
    in-out property <[TrackpointSettingModel]> trackpoint-dynamic-scrolling-settings: [];

    // Dynamic Trackball settings
    in-out property <bool> trackball-dynamic-device-off: false;
    in-out property <[TrackballSettingModel]> trackball-dynamic-general-settings: [];
    in-out property <[TrackballSettingModel]> trackball-dynamic-behavior-settings: [];
    in-out property <[TrackballSettingModel]> trackball-dynamic-acceleration-settings: [];
    in-out property <[TrackballSettingModel]> trackball-dynamic-scrolling-settings: [];

    // Dynamic Tablet settings
    in-out property <bool> tablet-dynamic-device-off: false;
    in-out property <[TabletSettingModel]> tablet-dynamic-general-settings: [];
    in-out property <[TabletSettingModel]> tablet-dynamic-mapping-settings: [];
    in-out property <[TabletSettingModel]> tablet-dynamic-calibration-settings: [];

    // Dynamic Touch settings
    in-out property <bool> touch-dynamic-device-off: false;
    in-out property <[TouchSettingModel]> touch-dynamic-general-settings: [];
    in-out property <[TouchSettingModel]> touch-dynamic-mapping-settings: [];
    in-out property <[TouchSettingModel]> touch-dynamic-calibration-settings: [];

    // Dynamic Startup settings
    in-out property <[string]> startup-dynamic-command-list: [];
    in-out property <int> startup-dynamic-selected-index: -1;
    in-out property <string> startup-dynamic-current-command: "";

    // Dynamic Environment settings
    in-out property <[EnvironmentVariableModel]> environment-dynamic-variable-list: [];
    in-out property <int> environment-dynamic-selected-index: -1;
    in-out property <string> environment-dynamic-current-name: "";
    in-out property <string> environment-dynamic-current-value: "";

    // Wizard state
    in-out property <bool> wizard-visible: false;
    in-out property <int> wizard-step: 0;
    in-out property <bool> has-include-line: false;
    in-out property <string> config-path: "~/.config/niri/config.kdl";
    in-out property <string> include-line: "include \"niri-settings/main.kdl\"";

    // Import summary (for first run)
    in-out property <string> import-summary: "";
    in-out property <bool> has-imports: false;
    in-out property <int> import-count: 0;
    in-out property <int> import-defaulted-count: 0;
    in-out property <int> import-includes-count: 0;
    in-out property <[string]> import-warnings: [];
    in-out property <bool> show-import-details: false;

    // Consolidation suggestions
    in-out property <bool> show-consolidation-dialog: false;
    in-out property <[ConsolidationItem]> consolidation-suggestions: [];
    in-out property <int> consolidation-affected-rules: 0;
    callback consolidation-dismissed();
    callback consolidation-apply-selected();
    callback consolidation-suggestion-toggled(int, bool);

    // Config diff view
    in-out property <bool> diff-view-visible: false;
    in property <[CategoryDiffItem]> diff-categories: [];
    in property <int> diff-total-additions: 0;
    in property <int> diff-total-deletions: 0;

    // Dialog state
    in-out property <bool> error-dialog-visible: false;
    in-out property <string> error-title: "Error";
    in-out property <string> error-message: "";
    in-out property <string> error-details: "";

    // Status notification (toast)
    in-out property <bool> status-visible: false;
    in-out property <string> status-message: "";
    in-out property <bool> status-is-error: false;

    // Callback for Rust to show toast notifications (Rust handles auto-dismiss timer)
    public function show-status-toast(msg: string, is-error: bool) {
        status-message = msg;
        status-is-error = is-error;
        status-visible = true;
    }

    // Hardware detection - controls visibility of input device tabs
    in-out property <bool> has-touchpad: true;
    in-out property <bool> has-trackpoint: true;
    in-out property <bool> has-trackball: true;
    in-out property <bool> has-tablet: true;
    in-out property <bool> has-touch: true;

    // Niri info
    in-out property <string> niri-version: "";
    in-out property <bool> niri-running: false;

    // Config validation
    in-out property <string> validation-result: "";
    in-out property <bool> validation-success: false;
    callback validate-config-requested();

    // Tools page
    in-out property <string> tools-output: "";
    in-out property <string> tools-last-action: "";
    callback tools-list-windows();
    callback tools-list-workspaces();
    callback tools-list-outputs();
    callback tools-focused-window();
    callback tools-focused-output();
    callback tools-reload-config();

    // Config editor properties
    in-out property <string> config-editor-content: "";
    in-out property <int> config-editor-file-index: 0;
    callback config-editor-load-file(int);
    callback config-editor-refresh();

    // Backup browser properties
    in-out property <[BackupEntry]> backup-list: [];
    in-out property <int> backup-selected-index: -1;
    in-out property <string> backup-preview: "";
    in-out property <string> backup-status: "";
    in-out property <bool> backup-has-backups: false;
    callback backup-refresh();
    callback backup-preview-requested(int);
    callback backup-restore-requested(int);

    callback close-requested();
    callback category-changed(int);
    callback search-changed(string);
    callback search-result-selected(int);  // Navigate to category from search result

    // Diff view callbacks
    callback review-changes-requested();
    callback diff-save-now();
    callback diff-discard-all();
    callback diff-close();

    // Wizard callbacks
    callback wizard-completed();
    callback wizard-cancelled();
    callback add-include-line-requested();

    // Dialog callbacks
    callback error-dismissed();

    // Appearance callbacks
    callback focus-ring-toggled(bool);
    callback focus-ring-width-changed(float);
    callback focus-ring-active-color-changed(color);
    callback focus-ring-inactive-color-changed(color);
    callback focus-ring-urgent-color-changed(color);
    callback border-toggled(bool);
    callback border-thickness-changed(float);
    callback border-active-color-changed(color);
    callback border-inactive-color-changed(color);
    callback border-urgent-color-changed(color);
    callback gaps-changed(float);
    callback background-color-changed(color);
    callback corner-radius-changed(float);

    // Behavior callbacks
    callback focus-follows-mouse-toggled(bool);
    callback warp-mouse-to-focus-toggled(bool);
    callback center-focused-column-toggled(bool);
    callback always-center-single-column-toggled(bool);
    callback default-column-width-type-changed(int);
    callback default-column-width-proportion-changed(float);
    callback default-column-width-fixed-changed(float);
    callback strut-left-changed(float);
    callback strut-right-changed(float);
    callback strut-top-changed(float);
    callback strut-bottom-changed(float);
    callback mod-key-changed(int);
    callback mod-key-nested-enabled-toggled(bool);
    callback mod-key-nested-changed(int);
    callback disable-power-key-handling-toggled(bool);

    // Cursor callbacks
    callback cursor-theme-changed(string);
    callback cursor-size-changed(int);
    callback hide-when-typing-toggled(bool);
    callback hide-after-inactive-toggled(bool);
    callback hide-after-inactive-ms-changed(int);

    // Animation callbacks
    callback animations-toggled(bool);
    callback animations-slowdown-changed(float);

    // Indexed animation callbacks (6 total instead of 66)
    // Each takes (animation_id, value) where animation_id is 0-10
    callback animation-type-changed(int /* id */, int /* type */);
    callback animation-damping-changed(int /* id */, float);
    callback animation-stiffness-changed(int /* id */, int);
    callback animation-epsilon-changed(int /* id */, float);
    callback animation-duration-changed(int /* id */, int);
    callback animation-curve-changed(int /* id */, int);
    // Cubic-bezier control point callbacks
    callback animation-bezier-x1-changed(int /* id */, float);
    callback animation-bezier-y1-changed(int /* id */, float);
    callback animation-bezier-x2-changed(int /* id */, float);
    callback animation-bezier-y2-changed(int /* id */, float);

    // Overview callbacks
    callback overview-zoom-changed(float);
    callback overview-backdrop-toggled(bool);
    callback overview-backdrop-color-changed(color);

    // Phase 8: Workspace shadow callbacks
    callback overview-workspace-shadow-toggled(bool);
    callback overview-workspace-shadow-softness-changed(float);
    callback overview-workspace-shadow-spread-changed(float);
    callback overview-workspace-shadow-offset-x-changed(float);
    callback overview-workspace-shadow-offset-y-changed(float);
    callback overview-workspace-shadow-color-changed(color);

    // Keyboard callbacks
    // Note: Keyboard cannot be disabled in niri, so no "off-toggled" callback
    callback xkb-layout-changed(string);
    callback xkb-variant-changed(string);
    callback xkb-model-changed(string);
    callback xkb-rules-changed(string);
    callback xkb-options-changed(string);
    callback xkb-file-changed(string);
    callback repeat-delay-changed(int);
    callback repeat-rate-changed(int);
    callback numlock-toggled(bool);
    callback track-layout-changed(int);

    // Mouse callbacks
    callback mouse-off-toggled(bool);
    callback mouse-natural-scroll-toggled(bool);
    callback mouse-left-handed-toggled(bool);
    callback mouse-accel-speed-changed(float);
    callback mouse-accel-profile-changed(int);
    callback mouse-scroll-factor-changed(float);
    callback mouse-scroll-method-changed(int);
    callback mouse-middle-emulation-toggled(bool);
    callback mouse-scroll-button-changed(int);
    callback mouse-scroll-button-lock-toggled(bool);

    // Touchpad callbacks
    callback touchpad-off-toggled(bool);
    callback touchpad-tap-toggled(bool);
    callback touchpad-tap-button-map-changed(int);
    callback touchpad-natural-scroll-toggled(bool);
    callback touchpad-scroll-method-changed(int);
    callback touchpad-scroll-factor-changed(float);
    callback touchpad-click-method-changed(int);
    callback touchpad-middle-emulation-toggled(bool);
    callback touchpad-left-handed-toggled(bool);
    callback touchpad-dwt-toggled(bool);
    callback touchpad-dwtp-toggled(bool);
    callback touchpad-drag-toggled(bool);
    callback touchpad-drag-lock-toggled(bool);
    callback touchpad-accel-speed-changed(float);
    callback touchpad-accel-profile-changed(int);
    callback touchpad-disabled-on-external-mouse-toggled(bool);
    callback touchpad-scroll-button-changed(int);
    callback touchpad-scroll-button-lock-toggled(bool);

    // Dynamic trackpoint callbacks
    callback trackpoint-setting-toggle-changed(string, bool);
    callback trackpoint-setting-slider-int-changed(string, int);
    callback trackpoint-setting-slider-float-changed(string, float);
    callback trackpoint-setting-combo-changed(string, int);
    callback trackpoint-setting-text-changed(string, string);

    // Dynamic trackball callbacks
    callback trackball-setting-toggle-changed(string, bool);
    callback trackball-setting-slider-int-changed(string, int);
    callback trackball-setting-slider-float-changed(string, float);
    callback trackball-setting-combo-changed(string, int);
    callback trackball-setting-text-changed(string, string);

    // Dynamic tablet callbacks
    callback tablet-setting-toggle-changed(string, bool);
    callback tablet-setting-slider-int-changed(string, int);
    callback tablet-setting-slider-float-changed(string, float);
    callback tablet-setting-combo-changed(string, int);
    callback tablet-setting-text-changed(string, string);

    // Dynamic touch callbacks
    callback touch-setting-toggle-changed(string, bool);
    callback touch-setting-slider-int-changed(string, int);
    callback touch-setting-slider-float-changed(string, float);
    callback touch-setting-combo-changed(string, int);
    callback touch-setting-text-changed(string, string);

    // Display/Output callbacks
    callback output-add(string);
    callback output-remove(int);
    callback output-select(int);
    callback output-discover();
    callback output-enabled-toggled(bool);
    callback output-scale-changed(float);
    callback output-mode-changed(string);
    callback output-pos-x-changed(int);
    callback output-pos-y-changed(int);
    callback output-transform-changed(int);
    callback output-vrr-changed(int);

    // Mode dropdown callbacks
    callback output-mode-selected(int);  // Mode selected from dropdown
    callback use-custom-mode-toggled(bool);  // Toggle for custom mode input

    // Phase 8: Per-output custom mode/modeline callbacks
    callback output-mode-custom-toggled(bool);
    callback output-modeline-changed(string);

    // Phase 8: Per-output hot corners callbacks
    callback output-hc-override-toggled(bool);
    callback output-hc-enabled-toggled(bool);
    callback output-hc-top-left-toggled(bool);
    callback output-hc-top-right-toggled(bool);
    callback output-hc-bottom-left-toggled(bool);
    callback output-hc-bottom-right-toggled(bool);

    // Phase 8: Per-output layout override callbacks
    callback output-layout-override-toggled(bool);
    callback output-layout-gaps-inner-changed(float);
    callback output-layout-gaps-outer-changed(float);
    callback output-layout-struts-left-changed(float);
    callback output-layout-struts-right-changed(float);
    callback output-layout-struts-top-changed(float);
    callback output-layout-struts-bottom-changed(float);
    callback output-layout-center-changed(int);

    // Layout Extras - Shadow callbacks
    callback shadow-toggled(bool);
    callback shadow-softness-changed(int);
    callback shadow-spread-changed(int);
    callback shadow-offset-x-changed(int);
    callback shadow-offset-y-changed(int);
    callback shadow-draw-behind-toggled(bool);
    callback shadow-color-changed(color);
    callback shadow-inactive-color-changed(color);

    // Layout Extras - Tab indicator callbacks
    callback tab-indicator-toggled(bool);
    callback tab-indicator-hide-single-toggled(bool);
    callback tab-indicator-within-column-toggled(bool);
    callback tab-indicator-gap-changed(int);
    callback tab-indicator-width-changed(int);
    callback tab-indicator-position-changed(int);
    callback tab-indicator-corner-radius-changed(int);
    callback tab-indicator-gaps-between-changed(int);
    callback tab-indicator-active-color-changed(color);
    callback tab-indicator-inactive-color-changed(color);
    callback tab-indicator-urgent-color-changed(color);

    // Layout Extras - Insert hint callbacks
    callback insert-hint-toggled(bool);
    callback insert-hint-color-changed(color);

    // Gestures - Hot corners callbacks
    callback hot-corners-toggled(bool);
    callback hot-corner-top-left-toggled(bool);
    callback hot-corner-top-right-toggled(bool);
    callback hot-corner-bottom-left-toggled(bool);
    callback hot-corner-bottom-right-toggled(bool);

    // Gestures - DND edge scroll callbacks
    callback dnd-edge-scroll-toggled(bool);
    callback dnd-edge-scroll-trigger-width-changed(int);
    callback dnd-edge-scroll-delay-changed(int);
    callback dnd-edge-scroll-max-speed-changed(int);

    // Gestures - DND workspace switch callbacks
    callback dnd-workspace-switch-toggled(bool);
    callback dnd-workspace-switch-trigger-height-changed(int);
    callback dnd-workspace-switch-delay-changed(int);
    callback dnd-workspace-switch-max-speed-changed(int);

    // Miscellaneous callbacks
    callback prefer-no-csd-toggled(bool);
    callback screenshot-path-changed(string);
    callback disable-primary-clipboard-toggled(bool);
    callback hotkey-overlay-skip-toggled(bool);

    // Phase 8: New misc callbacks
    callback hotkey-overlay-hide-not-bound-toggled(bool);
    callback config-notification-disable-failed-toggled(bool);

    // New misc callbacks (v25.08+)
    callback spawn-sh-at-startup-toggled(bool);
    callback xwayland-satellite-mode-changed(int);
    callback xwayland-satellite-path-changed(string);

    // Developer callbacks
    callback show-debug-options-toggled(bool);

    // Window Rules callbacks
    callback window-rule-add();
    callback window-rule-remove(int);
    callback window-rule-select(int);
    callback window-rule-name-changed(string);
    callback window-rule-reorder(int, int);  // from-index, to-index
    // Multi-match callbacks
    callback window-rule-add-match();
    callback window-rule-remove-match(int);
    callback window-rule-select-match(int);
    callback window-rule-match-app-id-changed(string);
    callback window-rule-match-title-changed(string);
    callback window-rule-match-is-floating-changed(int);
    callback window-rule-match-is-active-changed(int);
    callback window-rule-match-is-focused-changed(int);
    callback window-rule-match-is-active-in-column-changed(int);
    callback window-rule-match-is-window-cast-target-changed(int);
    callback window-rule-match-is-urgent-changed(int);
    callback window-rule-match-at-startup-changed(int);
    callback window-rule-open-behavior-changed(int);
    callback window-rule-opacity-toggled(bool);
    callback window-rule-opacity-changed(float);
    callback window-rule-block-screencast-toggled(bool);
    callback window-rule-corner-radius-toggled(bool);
    callback window-rule-corner-radius-changed(int);
    callback window-rule-clip-to-geometry-toggled(bool);
    callback window-rule-open-on-output-changed(string);
    callback window-rule-open-on-workspace-changed(string);
    // New dynamic property callbacks
    callback window-rule-vrr-changed(int);
    callback window-rule-column-display-changed(int);
    callback window-rule-tiled-state-changed(int);
    callback window-rule-baba-is-float-toggled(bool);
    // Floating position callbacks
    callback window-rule-floating-position-toggled(bool);
    callback window-rule-floating-position-x-changed(int);
    callback window-rule-floating-position-y-changed(int);
    callback window-rule-floating-position-relative-to-changed(int);
    // Window picker callbacks
    callback window-rule-refresh-windows();
    callback window-rule-select-running-window(int);
    // Shadow override callbacks
    callback window-rule-shadow-mode-changed(int);
    callback window-rule-shadow-softness-changed(int);
    callback window-rule-shadow-spread-changed(int);
    callback window-rule-shadow-offset-x-changed(int);
    callback window-rule-shadow-offset-y-changed(int);
    callback window-rule-shadow-color-changed(string);
    callback window-rule-shadow-inactive-color-changed(string);
    callback window-rule-shadow-draw-behind-window-toggled(bool);
    // Tab indicator override callbacks
    callback window-rule-tab-indicator-mode-changed(int);
    callback window-rule-tab-indicator-hide-when-single-toggled(bool);
    callback window-rule-tab-indicator-place-within-column-toggled(bool);
    callback window-rule-tab-indicator-gap-changed(int);
    callback window-rule-tab-indicator-width-changed(int);
    callback window-rule-tab-indicator-length-changed(float);
    callback window-rule-tab-indicator-position-changed(int);
    callback window-rule-tab-indicator-gaps-between-tabs-changed(int);
    callback window-rule-tab-indicator-corner-radius-changed(int);
    callback window-rule-tab-indicator-active-color-changed(string);
    callback window-rule-tab-indicator-inactive-color-changed(string);

    // Named Workspaces callbacks
    callback workspace-add();
    callback workspace-remove(int);
    callback workspace-select(int);
    callback workspace-name-changed(string);
    callback workspace-open-on-output-changed(string);
    callback workspace-layout-override-toggled(bool);
    callback workspace-gaps-override-toggled(bool);
    callback workspace-gaps-inner-changed(float);
    callback workspace-gaps-outer-changed(float);
    callback workspace-struts-override-toggled(bool);
    callback workspace-strut-left-changed(float);
    callback workspace-strut-right-changed(float);
    callback workspace-strut-top-changed(float);
    callback workspace-strut-bottom-changed(float);
    callback workspace-center-override-toggled(bool);
    callback workspace-center-focused-column-changed(int);
    callback workspace-always-center-single-column-toggled(bool);

    // Layer Rules callbacks
    callback layer-rule-add();
    callback layer-rule-remove(int);
    callback layer-rule-select(int);
    callback layer-rule-name-changed(string);
    callback layer-rule-reorder(int, int);  // from-index, to-index
    callback layer-rule-add-match();
    callback layer-rule-remove-match(int);
    callback layer-rule-select-match(int);
    callback layer-rule-match-namespace-changed(string);
    callback layer-rule-match-at-startup-has-toggled(bool);
    callback layer-rule-match-at-startup-toggled(bool);
    callback layer-rule-block-out-from-toggled(bool);
    callback layer-rule-block-out-from-changed(int);
    callback layer-rule-opacity-toggled(bool);
    callback layer-rule-opacity-changed(float);
    callback layer-rule-corner-radius-toggled(bool);
    callback layer-rule-corner-radius-changed(int);
    callback layer-rule-place-within-backdrop-toggled(bool);
    callback layer-rule-baba-is-float-toggled(bool);
    callback layer-rule-shadow-toggled(bool);
    callback layer-rule-shadow-enabled-toggled(bool);
    callback layer-rule-shadow-softness-changed(int);
    callback layer-rule-shadow-spread-changed(int);
    callback layer-rule-shadow-offset-x-changed(int);
    callback layer-rule-shadow-offset-y-changed(int);
    callback layer-rule-shadow-draw-behind-toggled(bool);
    callback layer-rule-shadow-color-changed(color);
    callback layer-rule-shadow-inactive-color-changed(color);

    // Dynamic Layer Rules callbacks
    callback layer-rule-add-dynamic();
    callback layer-rule-remove-dynamic(int);
    callback layer-rule-select-dynamic(int);
    callback layer-rule-reorder-dynamic(int, int);
    callback layer-rule-add-match-dynamic();
    callback layer-rule-remove-match-dynamic(int);
    callback layer-rule-select-match-dynamic(int);
    callback layer-rule-setting-toggle-changed(string, bool);
    callback layer-rule-setting-slider-int-changed(string, int);
    callback layer-rule-setting-slider-float-changed(string, float);
    callback layer-rule-setting-combo-changed(string, int);
    callback layer-rule-setting-text-changed(string, string);
    callback layer-rule-setting-color-changed(string, color);

    // Dynamic Cursor callbacks
    callback cursor-setting-toggle-changed(string, bool);
    callback cursor-setting-slider-int-changed(string, int);
    callback cursor-setting-text-changed(string, string);

    // Dynamic Appearance callbacks
    callback appearance-setting-toggle-changed(string, bool);
    callback appearance-setting-slider-int-changed(string, int);
    callback appearance-setting-slider-float-changed(string, float);
    callback appearance-setting-combo-changed(string, int);
    callback appearance-setting-text-changed(string, string);
    callback appearance-setting-color-changed(string, color);

    // Dynamic Behavior callbacks
    callback behavior-setting-toggle-changed(string, bool);
    callback behavior-setting-slider-int-changed(string, int);
    callback behavior-setting-slider-float-changed(string, float);
    callback behavior-setting-combo-changed(string, int);
    callback behavior-setting-text-changed(string, string);

    // Dynamic Overview callbacks
    callback overview-setting-toggle-changed(string, bool);
    callback overview-setting-slider-int-changed(string, int);
    callback overview-setting-slider-float-changed(string, float);
    callback overview-setting-combo-changed(string, int);
    callback overview-setting-text-changed(string, string);
    callback overview-setting-color-changed(string, color);

    // Dynamic Keyboard callbacks
    callback keyboard-dynamic-setting-toggle-changed(string, bool);
    callback keyboard-dynamic-setting-slider-int-changed(string, int);
    callback keyboard-dynamic-setting-slider-float-changed(string, float);
    callback keyboard-dynamic-setting-combo-changed(string, int);
    callback keyboard-dynamic-setting-text-changed(string, string);

    // Dynamic Mouse callbacks
    callback mouse-setting-toggle-changed(string, bool);
    callback mouse-setting-slider-int-changed(string, int);
    callback mouse-setting-slider-float-changed(string, float);
    callback mouse-setting-combo-changed(string, int);
    callback mouse-setting-text-changed(string, string);

    // Dynamic Touchpad callbacks
    callback touchpad-setting-toggle-changed(string, bool);
    callback touchpad-setting-slider-int-changed(string, int);
    callback touchpad-setting-slider-float-changed(string, float);
    callback touchpad-setting-combo-changed(string, int);
    callback touchpad-setting-text-changed(string, string);

    // Dynamic Layout Extras callbacks
    callback layout-extras-setting-toggle-changed(string, bool);
    callback layout-extras-setting-slider-int-changed(string, int);
    callback layout-extras-setting-slider-float-changed(string, float);
    callback layout-extras-setting-combo-changed(string, int);
    callback layout-extras-setting-color-changed(string, string);

    // Dynamic Gestures callbacks
    callback gestures-setting-toggle-changed(string, bool);
    callback gestures-setting-slider-int-changed(string, int);
    callback gestures-setting-slider-float-changed(string, float);
    callback gestures-setting-combo-changed(string, int);
    callback gestures-hot-corner-toggled(string, bool);

    // Dynamic Miscellaneous callbacks
    callback misc-setting-toggle-changed(string, bool);
    callback misc-setting-slider-int-changed(string, int);
    callback misc-setting-slider-float-changed(string, float);
    callback misc-setting-combo-changed(string, int);
    callback misc-setting-text-changed(string, string);

    // Dynamic Debug callbacks
    callback debug-setting-toggle-changed(string, bool);
    callback debug-setting-slider-int-changed(string, int);
    callback debug-setting-slider-float-changed(string, float);
    callback debug-setting-combo-changed(string, int);
    callback debug-setting-text-changed(string, string);
    callback debug-validate-requested();
    callback debug-dynamic-expert-mode-toggled(bool);

    // Dynamic Animation callbacks
    callback anim-setting-toggle-changed(string, bool);
    callback anim-setting-slider-int-changed(string, int);
    callback anim-setting-slider-float-changed(string, float);
    callback anim-setting-combo-changed(string, int);

    // Dynamic Switch Events callbacks
    callback switch-events-setting-toggle-changed(string, bool);
    callback switch-events-setting-slider-int-changed(string, int);
    callback switch-events-setting-combo-changed(string, int);
    callback switch-events-setting-text-changed(string, string);
    callback switch-events-command-add(string, string);
    callback switch-events-command-remove(string, int);
    callback switch-events-command-select(string, int);
    callback switch-events-command-text-changed(string, string);

    // Keybindings callbacks
    callback keybindings-refresh();
    callback keybinding-selected(int);
    callback keybinding-add();
    callback keybinding-edit();
    callback keybinding-delete(int);
    callback keybindings-import();
    callback keybindings-import-from-file();
    callback keybinding-editor-close();
    callback keybinding-key-combo-changed(string);
    callback keybinding-raw-key-pressed(/* text */ string, /* meta */ bool, /* ctrl */ bool, /* alt */ bool, /* shift */ bool);
    callback keybinding-action-type-changed(int);
    callback keybinding-action-command-changed(string);
    callback keybinding-action-name-changed(string);
    callback keybinding-allow-when-locked-changed(bool);
    callback keybinding-repeat-changed(bool);
    callback keybinding-cooldown-changed(int);
    callback keybinding-overlay-title-changed(string);

    // Startup command callbacks
    callback startup-add-command();
    callback startup-remove-command(int);
    callback startup-select-command(int);
    callback startup-command-changed(string);
    callback startup-reorder-command(int, int);

    // Dynamic startup callbacks
    callback startup-dynamic-command-add();
    callback startup-dynamic-command-remove(int);
    callback startup-dynamic-command-select(int);
    callback startup-dynamic-command-changed(string);
    callback startup-dynamic-reorder-command(int, int);

    // Environment variable callbacks
    callback environment-add-variable();
    callback environment-remove-variable(int);
    callback environment-select-variable(int);
    callback environment-name-changed(string);
    callback environment-value-changed(string);
    callback environment-reorder-variable(int, int);

    // Dynamic environment callbacks
    callback environment-dynamic-add-variable();
    callback environment-dynamic-remove-variable(int);
    callback environment-dynamic-select-variable(int);
    callback environment-dynamic-name-changed(string);
    callback environment-dynamic-value-changed(string);
    callback environment-dynamic-reorder-variable(int, int);

    // Debug callbacks
    callback debug-expert-mode-toggled(bool);
    callback debug-preview-render-toggled(bool);
    callback debug-enable-overlay-planes-toggled(bool);
    callback debug-disable-cursor-plane-toggled(bool);
    callback debug-disable-direct-scanout-toggled(bool);
    callback debug-restrict-primary-scanout-to-matching-format-toggled(bool);
    callback debug-render-drm-device-changed(string);
    callback debug-ignore-drm-devices-changed(string);
    callback debug-wait-for-frame-completion-toggled(bool);
    callback debug-disable-resize-throttling-toggled(bool);
    callback debug-disable-transactions-toggled(bool);
    callback debug-emulate-zero-presentation-time-toggled(bool);
    callback debug-skip-cursor-only-updates-during-vrr-toggled(bool);
    callback debug-dbus-interfaces-in-non-session-toggled(bool);
    callback debug-keep-laptop-panel-on-lid-closed-toggled(bool);
    callback debug-disable-monitor-names-toggled(bool);
    callback debug-force-disable-connectors-on-resume-toggled(bool);
    callback debug-strict-new-window-focus-toggled(bool);
    callback debug-honor-xdg-activation-with-invalid-serial-toggled(bool);
    callback debug-deactivate-unfocused-windows-toggled(bool);
    callback debug-force-pipewire-invalid-modifier-toggled(bool);

    // Switch events callbacks: lid-close
    callback switch-lid-close-add();
    callback switch-lid-close-remove(int);
    callback switch-lid-close-select(int);
    callback switch-lid-close-changed(string);

    // Switch events callbacks: lid-open
    callback switch-lid-open-add();
    callback switch-lid-open-remove(int);
    callback switch-lid-open-select(int);
    callback switch-lid-open-changed(string);

    // Switch events callbacks: tablet-mode-on
    callback switch-tablet-mode-on-add();
    callback switch-tablet-mode-on-remove(int);
    callback switch-tablet-mode-on-select(int);
    callback switch-tablet-mode-on-changed(string);

    // Switch events callbacks: tablet-mode-off
    callback switch-tablet-mode-off-add();
    callback switch-tablet-mode-off-remove(int);
    callback switch-tablet-mode-off-select(int);
    callback switch-tablet-mode-off-changed(string);

    // Recent windows callbacks
    callback recent-windows-enabled-toggled(bool);
    callback recent-windows-debounce-ms-changed(int);
    callback recent-windows-open-delay-ms-changed(int);
    callback recent-windows-highlight-active-color-changed(color);
    callback recent-windows-highlight-urgent-color-changed(color);
    callback recent-windows-highlight-padding-changed(int);
    callback recent-windows-highlight-corner-radius-changed(int);
    callback recent-windows-previews-max-height-changed(int);
    callback recent-windows-previews-max-scale-changed(float);

    // Dynamic recent windows callbacks
    callback recent-windows-dynamic-setting-toggle-changed(string, bool);
    callback recent-windows-dynamic-setting-slider-int-changed(string, int);
    callback recent-windows-dynamic-setting-slider-float-changed(string, float);
    callback recent-windows-dynamic-setting-combo-changed(string, int);
    callback recent-windows-dynamic-setting-text-changed(string, string);
    callback recent-windows-dynamic-setting-color-changed(string, color);

    // Category names for display
    property <[string]> category-names: [
        "Appearance",
        "Behavior",
        "Keyboard",
        "Mouse",
        "Touchpad",
        "Displays",
        "Animations",
        "Cursor",
        "Overview",
        "Layout Extras",
        "Gestures",
        "Miscellaneous",
        "Window Rules",
        "Input Devices",
        "Workspaces",
        "Layer Rules",
        "Trackpoint",
        "Trackball",
        "Tablet",
        "Touch",
        "Keybindings",
        "Startup",
        "Environment"
    ];

    // Navigation state - maps to actual category indices
    in-out property <int> nav-group: 0;
    in-out property <int> nav-page: 0;

    // Computed category accent based on nav-group
    property <color> category-accent:
        nav-group == 0 ? Theme.accent-visual :   // Appearance
        nav-group == 1 ? Theme.accent-input :    // Input
        nav-group == 2 ? Theme.accent-visual :   // Visuals
        nav-group == 3 ? Theme.accent-layout :   // Layout
        nav-group == 4 ? Theme.accent-rules :    // Rules
        Theme.accent-system;                      // System

    // Map (group, page) to actual SidebarIndices
    function compute-category(group: int, page: int) -> int {
        // Appearance group
        if group == 0 { return SidebarIndices.appearance; }
        // Input group
        if group == 1 {
            if page == 0 { return SidebarIndices.keyboard; }
            if page == 1 { return SidebarIndices.mouse; }
            if page == 2 { return SidebarIndices.touchpad; }
            if page == 3 { return SidebarIndices.trackpoint; }
            if page == 4 { return SidebarIndices.trackball; }
            if page == 5 { return SidebarIndices.tablet; }
            if page == 6 { return SidebarIndices.touch; }
            return SidebarIndices.displays;
        }
        // Visuals group
        if group == 2 {
            if page == 0 { return SidebarIndices.animations; }
            if page == 1 { return SidebarIndices.cursor; }
            if page == 2 { return SidebarIndices.overview; }
            return SidebarIndices.recent-windows;
        }
        // Layout group
        if group == 3 {
            if page == 0 { return SidebarIndices.behavior; }
            if page == 1 { return SidebarIndices.layout-extras; }
            return SidebarIndices.workspaces;
        }
        // Rules group
        if group == 4 {
            if page == 0 { return SidebarIndices.window-rules; }
            if page == 1 { return SidebarIndices.layer-rules; }
            return SidebarIndices.gestures;
        }
        // System group
        if page == 0 { return SidebarIndices.keybindings; }
        if page == 1 { return SidebarIndices.startup; }
        if page == 2 { return SidebarIndices.environment; }
        if page == 3 { return SidebarIndices.switch-events; }
        if page == 4 { return SidebarIndices.miscellaneous; }
        return SidebarIndices.debug;
    }

    // Reverse mapping: category index to group
    function category-to-group(category: int) -> int {
        if category == SidebarIndices.appearance { return 0; }
        // Input group
        if category == SidebarIndices.keyboard { return 1; }
        if category == SidebarIndices.mouse { return 1; }
        if category == SidebarIndices.touchpad { return 1; }
        if category == SidebarIndices.trackpoint { return 1; }
        if category == SidebarIndices.trackball { return 1; }
        if category == SidebarIndices.tablet { return 1; }
        if category == SidebarIndices.touch { return 1; }
        if category == SidebarIndices.displays { return 1; }
        // Visuals group
        if category == SidebarIndices.animations { return 2; }
        if category == SidebarIndices.cursor { return 2; }
        if category == SidebarIndices.overview { return 2; }
        if category == SidebarIndices.recent-windows { return 2; }
        // Layout group
        if category == SidebarIndices.behavior { return 3; }
        if category == SidebarIndices.layout-extras { return 3; }
        if category == SidebarIndices.workspaces { return 3; }
        // Rules group
        if category == SidebarIndices.window-rules { return 4; }
        if category == SidebarIndices.layer-rules { return 4; }
        if category == SidebarIndices.gestures { return 4; }
        // System group (default)
        return 5;
    }

    // Reverse mapping: category index to page within group
    function category-to-page(category: int) -> int {
        // Appearance group has only one page
        if category == SidebarIndices.appearance { return 0; }
        // Input group
        if category == SidebarIndices.keyboard { return 0; }
        if category == SidebarIndices.mouse { return 1; }
        if category == SidebarIndices.touchpad { return 2; }
        if category == SidebarIndices.trackpoint { return 3; }
        if category == SidebarIndices.trackball { return 4; }
        if category == SidebarIndices.tablet { return 5; }
        if category == SidebarIndices.touch { return 6; }
        if category == SidebarIndices.displays { return 7; }
        // Visuals group
        if category == SidebarIndices.animations { return 0; }
        if category == SidebarIndices.cursor { return 1; }
        if category == SidebarIndices.overview { return 2; }
        if category == SidebarIndices.recent-windows { return 3; }
        // Layout group
        if category == SidebarIndices.behavior { return 0; }
        if category == SidebarIndices.layout-extras { return 1; }
        if category == SidebarIndices.workspaces { return 2; }
        // Rules group
        if category == SidebarIndices.window-rules { return 0; }
        if category == SidebarIndices.layer-rules { return 1; }
        if category == SidebarIndices.gestures { return 2; }
        // System group
        if category == SidebarIndices.keybindings { return 0; }
        if category == SidebarIndices.startup { return 1; }
        if category == SidebarIndices.environment { return 2; }
        if category == SidebarIndices.switch-events { return 3; }
        if category == SidebarIndices.miscellaneous { return 4; }
        if category == SidebarIndices.debug { return 5; }
        return 0;
    }

    VerticalLayout {
        // Horizontal category navigation bar
        CategoryNav {
            selected-group <=> nav-group;
            selected-page <=> nav-page;
            show-debug-options <=> root.show-debug-options;

            group-changed(group) => {
                selected-category = compute-category(group, 0);
                category-changed(selected-category);
            }
            page-changed(page) => {
                selected-category = compute-category(nav-group, page);
                category-changed(selected-category);
            }
        }

        // Search bar
        search-bar-container := Rectangle {
            height: 48px;
            background: Theme.background;

            HorizontalLayout {
                padding-left: Theme.spacing-xl;
                padding-right: Theme.spacing-xl;
                padding-top: Theme.spacing-xs;
                padding-bottom: Theme.spacing-xs;
                spacing: Theme.spacing-md;

                SearchBar {
                    text <=> search-text;
                    horizontal-stretch: 1;
                    search-changed(query) => { root.search-changed(query); }
                }

                // Review Changes button
                Rectangle {
                    width: 120px;
                    height: 32px;
                    background: review-touch.has-hover ? Theme.surface-elevated : Theme.control-background;
                    border-radius: Theme.radius-md;
                    border-width: 1px;
                    border-color: Theme.border;

                    review-touch := TouchArea {
                        mouse-cursor: pointer;
                        clicked => { root.review-changes-requested(); }
                    }

                    HorizontalLayout {
                        padding: Theme.spacing-sm;
                        alignment: center;

                        Text {
                            text: "Review Changes";
                            color: Theme.text-secondary;
                            font-size: Theme.font-size-sm;
                            horizontal-alignment: center;
                            vertical-alignment: center;
                        }
                    }
                }
            }
        }

        // Content panel (full width, no sidebar)
        Rectangle {
            background: Theme.background;
            vertical-stretch: 1;

            // Page content based on selected category
            if selected-category == SidebarIndices.appearance: AppearanceDynamicPage {
                        sub-page: nav-group == 0 ? nav-page : 0;
                        focus-ring-settings <=> root.appearance-focus-ring-settings;
                        border-settings <=> root.appearance-border-settings;
                        background-settings <=> root.appearance-background-settings;
                        gaps-settings <=> root.appearance-gaps-settings;
                        corners-settings <=> root.appearance-corners-settings;

                        setting-toggle-changed(id, val) => { root.appearance-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.appearance-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.appearance-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.appearance-setting-combo-changed(id, val); }
                        setting-text-changed(id, val) => { root.appearance-setting-text-changed(id, val); }
                        setting-color-changed(id, col) => { root.appearance-setting-color-changed(id, col); }
                    }

                    if selected-category == SidebarIndices.behavior: BehaviorDynamicPage {
                        focus-settings <=> root.behavior-focus-settings;
                        workspace-settings <=> root.behavior-workspace-settings;
                        window-size-settings <=> root.behavior-window-size-settings;
                        strut-settings <=> root.behavior-strut-settings;
                        modifier-settings <=> root.behavior-modifier-settings;
                        power-settings <=> root.behavior-power-settings;

                        setting-toggle-changed(id, val) => { root.behavior-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.behavior-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.behavior-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.behavior-setting-combo-changed(id, val); }
                        setting-text-changed(id, val) => { root.behavior-setting-text-changed(id, val); }
                    }

                    if selected-category == SidebarIndices.keyboard: KeyboardDynamicPage {
                        layout-settings <=> root.keyboard-dynamic-layout-settings;
                        repeat-settings <=> root.keyboard-dynamic-repeat-settings;
                        other-settings <=> root.keyboard-dynamic-other-settings;
                        advanced-settings <=> root.keyboard-dynamic-advanced-settings;

                        setting-toggle-changed(id, val) => { root.keyboard-dynamic-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.keyboard-dynamic-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.keyboard-dynamic-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.keyboard-dynamic-setting-combo-changed(id, val); }
                        setting-text-changed(id, val) => { root.keyboard-dynamic-setting-text-changed(id, val); }
                    }

                    if selected-category == SidebarIndices.mouse: MouseDynamicPage {
                        device-off <=> root.mouse-dynamic-device-off;
                        device-settings <=> root.mouse-dynamic-device-settings;
                        basic-settings <=> root.mouse-dynamic-basic-settings;
                        acceleration-settings <=> root.mouse-dynamic-acceleration-settings;
                        scrolling-settings <=> root.mouse-dynamic-scrolling-settings;

                        setting-toggle-changed(id, val) => { root.mouse-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.mouse-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.mouse-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.mouse-setting-combo-changed(id, val); }
                        setting-text-changed(id, val) => { root.mouse-setting-text-changed(id, val); }
                    }

                    if selected-category == SidebarIndices.touchpad: TouchpadDynamicPage {
                        device-off <=> root.touchpad-dynamic-device-off;
                        device-control-settings <=> root.touchpad-dynamic-device-control-settings;
                        tap-settings <=> root.touchpad-dynamic-tap-settings;
                        scroll-settings <=> root.touchpad-dynamic-scroll-settings;
                        click-settings <=> root.touchpad-dynamic-click-settings;
                        palm-rejection-settings <=> root.touchpad-dynamic-palm-rejection-settings;
                        drag-settings <=> root.touchpad-dynamic-drag-settings;
                        acceleration-settings <=> root.touchpad-dynamic-acceleration-settings;
                        other-settings <=> root.touchpad-dynamic-other-settings;

                        setting-toggle-changed(id, val) => { root.touchpad-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.touchpad-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.touchpad-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.touchpad-setting-combo-changed(id, val); }
                        setting-text-changed(id, val) => { root.touchpad-setting-text-changed(id, val); }
                    }

                    if selected-category == SidebarIndices.cursor: CursorDynamicPage {
                        theme-settings <=> root.cursor-theme-settings;
                        visibility-settings <=> root.cursor-visibility-settings;

                        setting-toggle-changed(id, val) => { root.cursor-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.cursor-setting-slider-int-changed(id, val); }
                        setting-text-changed(id, val) => { root.cursor-setting-text-changed(id, val); }
                    }

                    if selected-category == SidebarIndices.animations: AnimationsDynamicPage {
                        animations-enabled <=> root.animations-enabled;
                        global-settings <=> root.anim-global-settings;
                        workspace-nav-animations <=> root.anim-workspace-nav-animations;
                        window-animations <=> root.anim-window-animations;
                        ui-animations <=> root.anim-ui-animations;
                        spring-params-0 <=> root.anim-spring-params-0;
                        spring-params-1 <=> root.anim-spring-params-1;
                        spring-params-2 <=> root.anim-spring-params-2;
                        spring-params-3 <=> root.anim-spring-params-3;
                        spring-params-4 <=> root.anim-spring-params-4;
                        spring-params-5 <=> root.anim-spring-params-5;
                        spring-params-6 <=> root.anim-spring-params-6;
                        spring-params-7 <=> root.anim-spring-params-7;
                        spring-params-8 <=> root.anim-spring-params-8;
                        spring-params-9 <=> root.anim-spring-params-9;
                        spring-params-10 <=> root.anim-spring-params-10;
                        easing-params-0 <=> root.anim-easing-params-0;
                        easing-params-1 <=> root.anim-easing-params-1;
                        easing-params-2 <=> root.anim-easing-params-2;
                        easing-params-3 <=> root.anim-easing-params-3;
                        easing-params-4 <=> root.anim-easing-params-4;
                        easing-params-5 <=> root.anim-easing-params-5;
                        easing-params-6 <=> root.anim-easing-params-6;
                        easing-params-7 <=> root.anim-easing-params-7;
                        easing-params-8 <=> root.anim-easing-params-8;
                        easing-params-9 <=> root.anim-easing-params-9;
                        easing-params-10 <=> root.anim-easing-params-10;

                        setting-toggle-changed(id, val) => { root.anim-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.anim-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.anim-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.anim-setting-combo-changed(id, val); }
                    }

                    if selected-category == SidebarIndices.overview: OverviewDynamicPage {
                        appearance-settings <=> root.overview-appearance-settings;
                        backdrop-settings <=> root.overview-backdrop-settings;
                        shadow-settings <=> root.overview-shadow-settings;

                        setting-toggle-changed(id, val) => { root.overview-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.overview-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.overview-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.overview-setting-combo-changed(id, val); }
                        setting-text-changed(id, val) => { root.overview-setting-text-changed(id, val); }
                        setting-color-changed(id, col) => { root.overview-setting-color-changed(id, col); }
                    }

                    if selected-category == SidebarIndices.displays: DisplaysPage {
                        expert-mode: root.debug-expert-mode;

                        output-list <=> root.output-list;
                        discovered-outputs <=> root.discovered-outputs;
                        output-names <=> root.output-names;
                        selected-output-index <=> root.selected-output-index;
                        current-output-name <=> root.current-output-name;
                        current-output-enabled <=> root.current-output-enabled;
                        current-output-scale <=> root.current-output-scale;
                        current-output-mode <=> root.current-output-mode;
                        current-output-pos-x <=> root.current-output-pos-x;
                        current-output-pos-y <=> root.current-output-pos-y;
                        current-output-transform-index <=> root.current-output-transform-index;
                        current-output-vrr-index <=> root.current-output-vrr-index;
                        new-output-name <=> root.new-output-name;

                        // Mode dropdown
                        available-modes <=> root.available-modes;
                        selected-mode-index <=> root.selected-mode-index;
                        use-custom-mode <=> root.use-custom-mode;

                        // Phase 8: Custom mode/modeline
                        current-output-mode-custom <=> root.current-output-mode-custom;
                        current-output-modeline <=> root.current-output-modeline;

                        // Phase 8: Per-output hot corners
                        current-output-hot-corners-enabled <=> root.current-output-hot-corners-enabled;
                        current-output-hc-override-enabled <=> root.current-output-hc-override-enabled;
                        current-output-hc-top-left <=> root.current-output-hc-top-left;
                        current-output-hc-top-right <=> root.current-output-hc-top-right;
                        current-output-hc-bottom-left <=> root.current-output-hc-bottom-left;
                        current-output-hc-bottom-right <=> root.current-output-hc-bottom-right;

                        // Phase 8: Per-output layout override
                        current-output-layout-override-enabled <=> root.current-output-layout-override-enabled;
                        current-output-layout-gaps-inner <=> root.current-output-layout-gaps-inner;
                        current-output-layout-gaps-outer <=> root.current-output-layout-gaps-outer;
                        current-output-layout-struts-left <=> root.current-output-layout-struts-left;
                        current-output-layout-struts-right <=> root.current-output-layout-struts-right;
                        current-output-layout-struts-top <=> root.current-output-layout-struts-top;
                        current-output-layout-struts-bottom <=> root.current-output-layout-struts-bottom;
                        current-output-layout-center-index <=> root.current-output-layout-center-index;

                        add-output(name) => { root.output-add(name); }
                        remove-output(idx) => { root.output-remove(idx); }
                        select-output(idx) => { root.output-select(idx); }
                        discover-outputs() => { root.output-discover(); }
                        output-enabled-toggled(val) => { root.output-enabled-toggled(val); }
                        output-scale-changed(val) => { root.output-scale-changed(val); }
                        output-mode-changed(val) => { root.output-mode-changed(val); }
                        output-pos-x-changed(val) => { root.output-pos-x-changed(val); }
                        output-pos-y-changed(val) => { root.output-pos-y-changed(val); }
                        output-transform-changed(idx) => { root.output-transform-changed(idx); }
                        output-vrr-changed(idx) => { root.output-vrr-changed(idx); }

                        // Mode dropdown callbacks
                        output-mode-selected(idx) => { root.output-mode-selected(idx); }
                        use-custom-mode-toggled(val) => { root.use-custom-mode-toggled(val); }

                        // Phase 8 callbacks
                        output-mode-custom-toggled(val) => { root.output-mode-custom-toggled(val); }
                        output-modeline-changed(val) => { root.output-modeline-changed(val); }
                        output-hc-override-toggled(val) => { root.output-hc-override-toggled(val); }
                        output-hc-enabled-toggled(val) => { root.output-hc-enabled-toggled(val); }
                        output-hc-top-left-toggled(val) => { root.output-hc-top-left-toggled(val); }
                        output-hc-top-right-toggled(val) => { root.output-hc-top-right-toggled(val); }
                        output-hc-bottom-left-toggled(val) => { root.output-hc-bottom-left-toggled(val); }
                        output-hc-bottom-right-toggled(val) => { root.output-hc-bottom-right-toggled(val); }
                        output-layout-override-toggled(val) => { root.output-layout-override-toggled(val); }
                        output-layout-gaps-inner-changed(val) => { root.output-layout-gaps-inner-changed(val); }
                        output-layout-gaps-outer-changed(val) => { root.output-layout-gaps-outer-changed(val); }
                        output-layout-struts-left-changed(val) => { root.output-layout-struts-left-changed(val); }
                        output-layout-struts-right-changed(val) => { root.output-layout-struts-right-changed(val); }
                        output-layout-struts-top-changed(val) => { root.output-layout-struts-top-changed(val); }
                        output-layout-struts-bottom-changed(val) => { root.output-layout-struts-bottom-changed(val); }
                        output-layout-center-changed(idx) => { root.output-layout-center-changed(idx); }
                    }

                    if selected-category == SidebarIndices.layout-extras: LayoutExtrasDynamicPage {
                        shadow-settings <=> root.layout-extras-shadow-settings;
                        tab-indicator-settings <=> root.layout-extras-tab-indicator-settings;
                        insert-hint-settings <=> root.layout-extras-insert-hint-settings;

                        setting-toggle-changed(id, val) => { root.layout-extras-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.layout-extras-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.layout-extras-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.layout-extras-setting-combo-changed(id, val); }
                        setting-color-changed(id, col) => { root.layout-extras-setting-color-changed(id, col); }
                    }

                    if selected-category == SidebarIndices.gestures: GesturesDynamicPage {
                        hot-corners-enabled <=> root.gestures-hot-corners-enabled;
                        hot-corner-top-left <=> root.gestures-hot-corner-top-left;
                        hot-corner-top-right <=> root.gestures-hot-corner-top-right;
                        hot-corner-bottom-left <=> root.gestures-hot-corner-bottom-left;
                        hot-corner-bottom-right <=> root.gestures-hot-corner-bottom-right;
                        hot-corners-settings <=> root.gestures-hot-corners-settings;
                        dnd-edge-scroll-settings <=> root.gestures-dnd-edge-scroll-settings;
                        dnd-workspace-switch-settings <=> root.gestures-dnd-workspace-switch-settings;

                        setting-toggle-changed(id, val) => { root.gestures-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.gestures-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.gestures-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.gestures-setting-combo-changed(id, val); }
                        hot-corner-toggled(id, val) => { root.gestures-hot-corner-toggled(id, val); }
                    }

                    if selected-category == SidebarIndices.miscellaneous: MiscellaneousDynamicPage {
                        decorations-settings <=> root.misc-decorations-settings;
                        screenshots-settings <=> root.misc-screenshots-settings;
                        screenshot-path-setting <=> root.misc-screenshot-path-setting;
                        clipboard-settings <=> root.misc-clipboard-settings;
                        hotkey-overlay-settings <=> root.misc-hotkey-overlay-settings;
                        config-notification-settings <=> root.misc-config-notification-settings;
                        startup-settings <=> root.misc-startup-settings;
                        xwayland-settings <=> root.misc-xwayland-settings;
                        xwayland-path-setting <=> root.misc-xwayland-path-setting;
                        developer-settings <=> root.misc-developer-settings;

                        setting-toggle-changed(id, val) => { root.misc-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.misc-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.misc-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.misc-setting-combo-changed(id, val); }
                        setting-text-changed(id, val) => { root.misc-setting-text-changed(id, val); }
                    }

                    // DYNAMIC WINDOW RULES PAGE (replaces 123 lines with 30)
                    if selected-category == SidebarIndices.window-rules: WindowRulesPageDynamic {
                        rule-list <=> root.window-rules-list-dynamic;
                        selected-rule-index <=> root.selected-window-rule-index-dynamic;
                        matches-list <=> root.window-rules-matches-list-dynamic;
                        selected-match-index <=> root.selected-match-index-dynamic;
                        running-windows <=> root.window-rules-running-windows-dynamic;
                        show-window-picker <=> root.window-rules-show-picker-dynamic;
                        rule-settings <=> root.window-rules-rule-settings;
                        match-settings <=> root.window-rules-match-settings;
                        opening-settings <=> root.window-rules-opening-settings;
                        visual-settings <=> root.window-rules-visual-settings;
                        shadow-settings <=> root.window-rules-shadow-settings;
                        tab-settings <=> root.window-rules-tab-settings;

                        add-rule => { root.window-rule-add-dynamic(); }
                        remove-rule(idx) => { root.window-rule-remove-dynamic(idx); }
                        select-rule(idx) => { root.window-rule-select-dynamic(idx); }
                        reorder-rule(from, to) => { root.window-rule-reorder-dynamic(from, to); }
                        add-match => { root.window-rule-add-match-dynamic(); }
                        remove-match(idx) => { root.window-rule-remove-match-dynamic(idx); }
                        select-match(idx) => { root.window-rule-select-match-dynamic(idx); }
                        refresh-windows => { root.window-rule-refresh-windows-dynamic(); }
                        select-running-window(idx) => { root.window-rule-select-running-window-dynamic(idx); }
                        setting-toggle-changed(id, val) => { root.window-rule-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.window-rule-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.window-rule-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.window-rule-setting-combo-changed(id, val); }
                        setting-text-changed(id, val) => { root.window-rule-setting-text-changed(id, val); }
                    }

                    // 
                    // TRACKPOINT PAGE (category 16) - Dynamic
                    // 
                    if selected-category == SidebarIndices.trackpoint: TrackpointDynamicPage {
                        device-off <=> root.trackpoint-dynamic-device-off;
                        general-settings <=> root.trackpoint-dynamic-general-settings;
                        behavior-settings <=> root.trackpoint-dynamic-behavior-settings;
                        acceleration-settings <=> root.trackpoint-dynamic-acceleration-settings;
                        scrolling-settings <=> root.trackpoint-dynamic-scrolling-settings;

                        setting-toggle-changed(id, val) => { root.trackpoint-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.trackpoint-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.trackpoint-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.trackpoint-setting-combo-changed(id, val); }
                        setting-text-changed(id, val) => { root.trackpoint-setting-text-changed(id, val); }
                    }

                    // 
                    // TRACKBALL PAGE (category 17) - Dynamic
                    // 
                    if selected-category == SidebarIndices.trackball: TrackballDynamicPage {
                        device-off <=> root.trackball-dynamic-device-off;
                        general-settings <=> root.trackball-dynamic-general-settings;
                        behavior-settings <=> root.trackball-dynamic-behavior-settings;
                        acceleration-settings <=> root.trackball-dynamic-acceleration-settings;
                        scrolling-settings <=> root.trackball-dynamic-scrolling-settings;

                        setting-toggle-changed(id, val) => { root.trackball-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.trackball-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.trackball-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.trackball-setting-combo-changed(id, val); }
                        setting-text-changed(id, val) => { root.trackball-setting-text-changed(id, val); }
                    }

                    // 
                    // TABLET PAGE (category 18) - Dynamic
                    // 
                    if selected-category == SidebarIndices.tablet: TabletDynamicPage {
                        device-off <=> root.tablet-dynamic-device-off;
                        general-settings <=> root.tablet-dynamic-general-settings;
                        mapping-settings <=> root.tablet-dynamic-mapping-settings;
                        calibration-settings <=> root.tablet-dynamic-calibration-settings;

                        setting-toggle-changed(id, val) => { root.tablet-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.tablet-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.tablet-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.tablet-setting-combo-changed(id, val); }
                        setting-text-changed(id, val) => { root.tablet-setting-text-changed(id, val); }
                    }

                    // 
                    // TOUCH PAGE (category 19) - Dynamic
                    // 
                    if selected-category == SidebarIndices.touch: TouchDynamicPage {
                        device-off <=> root.touch-dynamic-device-off;
                        general-settings <=> root.touch-dynamic-general-settings;
                        mapping-settings <=> root.touch-dynamic-mapping-settings;
                        calibration-settings <=> root.touch-dynamic-calibration-settings;

                        setting-toggle-changed(id, val) => { root.touch-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.touch-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.touch-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.touch-setting-combo-changed(id, val); }
                        setting-text-changed(id, val) => { root.touch-setting-text-changed(id, val); }
                    }

                    // Workspaces page (Dynamic)
                    if selected-category == SidebarIndices.workspaces: WorkspacesDynamicPage {
                        workspace-list <=> root.workspaces-list-dynamic;
                        selected-workspace-index <=> root.selected-workspace-index-dynamic;
                        workspace-identity-settings <=> root.workspace-identity-settings-dynamic;
                        layout-override-settings <=> root.workspace-layout-override-settings-dynamic;
                        gaps-settings <=> root.workspace-gaps-settings-dynamic;
                        struts-settings <=> root.workspace-struts-settings-dynamic;
                        centering-settings <=> root.workspace-centering-settings-dynamic;
                        has-layout-override <=> root.workspace-has-layout-override-dynamic;
                        has-gaps-override <=> root.workspace-has-gaps-override-dynamic;
                        has-struts-override <=> root.workspace-has-struts-override-dynamic;
                        has-center-override <=> root.workspace-has-center-override-dynamic;

                        add-workspace => { root.workspace-add-dynamic(); }
                        remove-workspace(idx) => { root.workspace-remove-dynamic(idx); }
                        select-workspace(idx) => { root.workspace-select-dynamic(idx); }
                        reorder-workspace(from, to) => { root.workspace-reorder-dynamic(from, to); }

                        setting-toggle-changed(id, val) => { root.workspace-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.workspace-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.workspace-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.workspace-setting-combo-changed(id, val); }
                        setting-text-changed(id, val) => { root.workspace-setting-text-changed(id, val); }
                    }

                    // Dynamic Layer Rules page
                    if selected-category == SidebarIndices.layer-rules: LayerRulesDynamicPage {
                        rule-list <=> root.layer-rules-list-dynamic;
                        selected-rule-index <=> root.layer-rules-selected-index;
                        matches-list <=> root.layer-rules-matches-list;
                        selected-match-index <=> root.layer-rules-selected-match-index;
                        matches-count <=> root.layer-rules-matches-count;

                        // Dynamic setting models
                        rule-settings <=> root.layer-rules-rule-settings;
                        match-settings <=> root.layer-rules-match-settings;
                        visual-settings <=> root.layer-rules-visual-settings;
                        shadow-settings <=> root.layer-rules-shadow-settings;
                        advanced-settings <=> root.layer-rules-advanced-settings;

                        // Rule management callbacks
                        add-rule => { root.layer-rule-add-dynamic(); }
                        remove-rule(idx) => { root.layer-rule-remove-dynamic(idx); }
                        select-rule(idx) => { root.layer-rule-select-dynamic(idx); }
                        reorder-rule(from, to) => { root.layer-rule-reorder-dynamic(from, to); }

                        // Match management callbacks
                        add-match => { root.layer-rule-add-match-dynamic(); }
                        remove-match(idx) => { root.layer-rule-remove-match-dynamic(idx); }
                        select-match(idx) => { root.layer-rule-select-match-dynamic(idx); }

                        // Generic setting callbacks
                        setting-toggle-changed(id, val) => { root.layer-rule-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.layer-rule-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.layer-rule-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.layer-rule-setting-combo-changed(id, val); }
                        setting-text-changed(id, val) => { root.layer-rule-setting-text-changed(id, val); }
                        setting-color-changed(id, val) => { root.layer-rule-setting-color-changed(id, val); }
                    }

                    // Keybindings page (full editing support)
                    if selected-category == SidebarIndices.keybindings: KeybindingsPage {
                        // List state
                        keybindings <=> root.keybindings-list;
                        selected-index <=> root.selected-keybinding-index;
                        loaded <=> root.keybindings-loaded;
                        source-file <=> root.keybindings-source-file;
                        error-message <=> root.keybindings-error;

                        // Editor state
                        editor-visible <=> root.keybinding-editor-visible;
                        edit-key-combo <=> root.edit-key-combo;
                        edit-key-parts <=> root.edit-key-parts;
                        edit-overlay-title <=> root.edit-overlay-title;
                        edit-allow-when-locked <=> root.edit-allow-when-locked;
                        edit-repeat <=> root.edit-repeat;
                        edit-cooldown <=> root.edit-cooldown;
                        edit-action-type <=> root.edit-action-type;
                        edit-action-command <=> root.edit-action-command;
                        edit-action-name <=> root.edit-action-name;

                        // Callbacks
                        refresh-keybindings => { root.keybindings-refresh(); }
                        keybinding-selected(idx) => { root.keybinding-selected(idx); }
                        keybinding-add => { root.keybinding-add(); }
                        keybinding-edit => { root.keybinding-edit(); }
                        keybinding-delete(idx) => { root.keybinding-delete(idx); }
                        keybindings-import => { root.keybindings-import(); }
                        keybindings-import-from-file => { root.keybindings-import-from-file(); }
                        keybinding-editor-close => { root.keybinding-editor-close(); }
                        key-combo-changed(val) => { root.keybinding-key-combo-changed(val); }
                        raw-key-pressed(text, meta, ctrl, alt, shift) => { root.keybinding-raw-key-pressed(text, meta, ctrl, alt, shift); }
                        action-type-changed(val) => { root.keybinding-action-type-changed(val); }
                        action-command-changed(val) => { root.keybinding-action-command-changed(val); }
                        action-name-changed(val) => { root.keybinding-action-name-changed(val); }
                        allow-when-locked-changed(val) => { root.keybinding-allow-when-locked-changed(val); }
                        repeat-changed(val) => { root.keybinding-repeat-changed(val); }
                        cooldown-changed(val) => { root.keybinding-cooldown-changed(val); }
                        overlay-title-changed(val) => { root.keybinding-overlay-title-changed(val); }
                    }

                    // Startup commands page (Dynamic)
                    if selected-category == SidebarIndices.startup: StartupDynamicPage {
                        command-list <=> root.startup-dynamic-command-list;
                        selected-index <=> root.startup-dynamic-selected-index;
                        current-command <=> root.startup-dynamic-current-command;

                        command-add => { root.startup-dynamic-command-add(); }
                        command-remove(idx) => { root.startup-dynamic-command-remove(idx); }
                        command-select(idx) => { root.startup-dynamic-command-select(idx); }
                        command-changed(val) => { root.startup-dynamic-command-changed(val); }
                        reorder-command(from, to) => { root.startup-dynamic-reorder-command(from, to); }
                    }

                    // Environment variables page (Dynamic)
                    if selected-category == SidebarIndices.environment: EnvironmentDynamicPage {
                        variable-list <=> root.environment-dynamic-variable-list;
                        selected-index <=> root.environment-dynamic-selected-index;
                        current-name <=> root.environment-dynamic-current-name;
                        current-value <=> root.environment-dynamic-current-value;

                        add-variable => { root.environment-dynamic-add-variable(); }
                        remove-variable(idx) => { root.environment-dynamic-remove-variable(idx); }
                        select-variable(idx) => { root.environment-dynamic-select-variable(idx); }
                        name-changed(val) => { root.environment-dynamic-name-changed(val); }
                        value-changed(val) => { root.environment-dynamic-value-changed(val); }
                        reorder-variable(from, to) => { root.environment-dynamic-reorder-variable(from, to); }
                    }

                    // Debug settings page (dynamic)
                    if selected-category == SidebarIndices.debug: DebugDynamicPage {
                        niri-version: root.niri-version;
                        niri-running: root.niri-running;
                        validate-requested => { root.debug-validate-requested(); }

                        expert-mode <=> root.debug-expert-mode;
                        expert-mode-toggled(val) => { root.debug-dynamic-expert-mode-toggled(val); }

                        rendering-settings <=> root.debug-rendering-settings;
                        gpu-settings <=> root.debug-gpu-settings;
                        frame-timing-settings <=> root.debug-frame-timing-settings;
                        window-management-settings <=> root.debug-window-management-settings;
                        system-settings <=> root.debug-system-settings;
                        screencasting-settings <=> root.debug-screencasting-settings;

                        setting-toggle-changed(id, val) => { root.debug-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.debug-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.debug-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.debug-setting-combo-changed(id, val); }
                        setting-text-changed(id, val) => { root.debug-setting-text-changed(id, val); }
                    }

                    // Switch events page (dynamic)
                    if selected-category == SidebarIndices.switch-events: SwitchEventsDynamicPage {
                        lid-close-commands <=> root.switch-lid-close-commands;
                        lid-close-selected <=> root.switch-lid-close-selected;
                        lid-close-current <=> root.switch-lid-close-current;
                        lid-open-commands <=> root.switch-lid-open-commands;
                        lid-open-selected <=> root.switch-lid-open-selected;
                        lid-open-current <=> root.switch-lid-open-current;
                        tablet-mode-on-commands <=> root.switch-tablet-mode-on-commands;
                        tablet-mode-on-selected <=> root.switch-tablet-mode-on-selected;
                        tablet-mode-on-current <=> root.switch-tablet-mode-on-current;
                        tablet-mode-off-commands <=> root.switch-tablet-mode-off-commands;
                        tablet-mode-off-selected <=> root.switch-tablet-mode-off-selected;
                        tablet-mode-off-current <=> root.switch-tablet-mode-off-current;
                        general-settings <=> root.switch-events-general-settings;

                        command-add(event-id, cmd) => { root.switch-events-command-add(event-id, cmd); }
                        command-remove(event-id, idx) => { root.switch-events-command-remove(event-id, idx); }
                        command-select(event-id, idx) => { root.switch-events-command-select(event-id, idx); }
                        command-text-changed(event-id, val) => { root.switch-events-command-text-changed(event-id, val); }

                        setting-toggle-changed(id, val) => { root.switch-events-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.switch-events-setting-slider-int-changed(id, val); }
                        setting-combo-changed(id, val) => { root.switch-events-setting-combo-changed(id, val); }
                        setting-text-changed(id, val) => { root.switch-events-setting-text-changed(id, val); }
                    }

                    // Recent windows page (Dynamic, v25.05+)
                    if selected-category == SidebarIndices.recent-windows: RecentWindowsDynamicPage {
                        feature-enabled <=> root.recent-windows-dynamic-feature-enabled;
                        general-settings <=> root.recent-windows-dynamic-general-settings;
                        highlight-settings <=> root.recent-windows-dynamic-highlight-settings;
                        preview-settings <=> root.recent-windows-dynamic-preview-settings;

                        setting-toggle-changed(id, val) => { root.recent-windows-dynamic-setting-toggle-changed(id, val); }
                        setting-slider-int-changed(id, val) => { root.recent-windows-dynamic-setting-slider-int-changed(id, val); }
                        setting-slider-float-changed(id, val) => { root.recent-windows-dynamic-setting-slider-float-changed(id, val); }
                        setting-combo-changed(id, val) => { root.recent-windows-dynamic-setting-combo-changed(id, val); }
                        setting-text-changed(id, val) => { root.recent-windows-dynamic-setting-text-changed(id, val); }
                        setting-color-changed(id, col) => { root.recent-windows-dynamic-setting-color-changed(id, col); }
                    }

                    // 
                    // TOOLS PAGE (category 26)
                    // 
                    if selected-category == SidebarIndices.tools: ToolsPage {
                        niri-running: root.niri-running;
                        output-text <=> root.tools-output;
                        last-action <=> root.tools-last-action;

                        list-windows-requested => { root.tools-list-windows(); }
                        list-workspaces-requested => { root.tools-list-workspaces(); }
                        list-outputs-requested => { root.tools-list-outputs(); }
                        focused-window-requested => { root.tools-focused-window(); }
                        focused-output-requested => { root.tools-focused-output(); }
                        reload-config-requested => { root.tools-reload-config(); }
                    }

                    // 
                    // CONFIG EDITOR PAGE (category 27)
                    // 
                    if selected-category == SidebarIndices.config-editor: ConfigEditorPage {
                        file-content <=> root.config-editor-content;
                        selected-file-index <=> root.config-editor-file-index;

                        load-file-requested(idx) => { root.config-editor-load-file(idx); }
                        refresh-requested => { root.config-editor-refresh(); }
                    }

                    // 
                    // BACKUPS PAGE (category 28)
                    // 
                    if selected-category == SidebarIndices.backups: BackupsPage {
                        backup-list <=> root.backup-list;
                        selected-backup-index <=> root.backup-selected-index;
                        preview-content <=> root.backup-preview;
                        status-message <=> root.backup-status;
                        has-backups <=> root.backup-has-backups;

                        refresh-requested => { root.backup-refresh(); }
                        preview-requested(idx) => { root.backup-preview-requested(idx); }
                        restore-requested(idx) => { root.backup-restore-requested(idx); }
                    }
        }  // Close Rectangle (content panel)

        // Bottom bar
        Rectangle {
            height: Theme.footer-height;
            background: Theme.sidebar-background;

            HorizontalLayout {
                padding: Theme.spacing-sm;
                spacing: Theme.spacing-sm;

                // Status text
                Text {
                    text: "Changes saved automatically";
                    color: Theme.text-muted;
                    font-size: Theme.font-size-sm;
                    vertical-alignment: center;
                    horizontal-stretch: 1;
                    accessible-role: text;
                    accessible-label: "Status: Changes saved automatically";
                }

                // Close button
                Button {
                    text: "Close";
                    accessible-label: "Close settings window";
                    accessible-description: "Close the application and save settings";
                    clicked => {
                        close-requested();
                    }
                }
            }
        }
    }

    // Search results overlay (positioned below CategoryNav + search bar)
    if show-search-results && search-results.length > 0: SearchResultsPanel {
        x: Theme.spacing-xl;
        y: 158px;  // CategoryNav (110px) + search bar (48px)
        width: root.width - Theme.spacing-xl * 2;
        results: search-results;
        accent-color: category-accent;

        result-selected(category) => {
            // Delegate to Rust handler which will set properties from outside
            // This avoids reactivity issues with setting properties from inside
            // a conditionally-rendered component's callback
            search-result-selected(category);
        }
    }

    // First-run wizard overlay
    FirstRunWizard {
        show-wizard: wizard-visible;
        current-step <=> wizard-step;
        has-include-line: root.has-include-line;
        config-path: root.config-path;
        include-line: root.include-line;
        import-summary: root.import-summary;
        has-imports: root.has-imports;

        wizard-completed => { root.wizard-completed(); }
        wizard-cancelled => { root.wizard-cancelled(); }
        add-include-line-requested => { root.add-include-line-requested(); }
    }

    // Error dialog overlay
    MessageDialog {
        show-dialog: error-dialog-visible;
        title: error-title;
        message: error-message;
        details: error-details;
        dialog-type: DialogType.Error;

        dismissed => { root.error-dismissed(); }
    }

    // Status notification (auto-dismiss timer handled in Rust)
    StatusNotification {
        show-notification: status-visible;
        message: status-message;
        notification-type: status-is-error ? DialogType.Error : DialogType.Success;

        dismissed => { root.status-visible = false; }
    }

    // Import summary dialog (shown after first-run if there are warnings)
    ImportSummaryDialog {
        show-dialog: show-import-details;
        imported-count: import-count;
        defaulted-count: import-defaulted-count;
        includes-processed: import-includes-count;
        warnings: import-warnings;

        dismissed => { root.show-import-details = false; }
    }

    // Config diff view dialog
    DiffViewDialog {
        show-dialog: root.diff-view-visible;
        categories: root.diff-categories;
        total-additions: root.diff-total-additions;
        total-deletions: root.diff-total-deletions;

        save-now => { root.diff-save-now(); }
        discard-all => { root.diff-discard-all(); }
        close-dialog => { root.diff-close(); }
    }

    // Consolidation suggestions dialog (shown after import if similar rules detected)
    ConsolidationDialog {
        show-dialog: root.show-consolidation-dialog;
        suggestions: root.consolidation-suggestions;
        total-affected-rules: root.consolidation-affected-rules;

        dismissed => { root.consolidation-dismissed(); }
        apply-selected => { root.consolidation-apply-selected(); }
        suggestion-toggled(index, selected) => { root.consolidation-suggestion-toggled(index, selected); }
    }
}
